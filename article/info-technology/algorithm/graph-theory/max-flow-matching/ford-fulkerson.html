<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Algorithm - Graph Theory - Ford-Fulkerson | YuweiYin</title>
    <meta name="description" content="Homepage of YuweiYin">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="/img/YuweiYin.jpeg">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.2d4b740c.css" as="style"><link rel="preload" href="/assets/js/app.07d900b0.js" as="script"><link rel="preload" href="/assets/js/2.5e710586.js" as="script"><link rel="preload" href="/assets/js/44.b6926593.js" as="script"><link rel="prefetch" href="/assets/js/10.877faa95.js"><link rel="prefetch" href="/assets/js/100.3879a691.js"><link rel="prefetch" href="/assets/js/101.92241ce5.js"><link rel="prefetch" href="/assets/js/102.b73e5682.js"><link rel="prefetch" href="/assets/js/103.26cf14f1.js"><link rel="prefetch" href="/assets/js/104.1388afaa.js"><link rel="prefetch" href="/assets/js/105.33c96508.js"><link rel="prefetch" href="/assets/js/106.48ff4913.js"><link rel="prefetch" href="/assets/js/107.e806ad4d.js"><link rel="prefetch" href="/assets/js/108.fd4ff1f9.js"><link rel="prefetch" href="/assets/js/109.4c415c03.js"><link rel="prefetch" href="/assets/js/11.49690d15.js"><link rel="prefetch" href="/assets/js/110.ab4c14cc.js"><link rel="prefetch" href="/assets/js/111.9a7665cb.js"><link rel="prefetch" href="/assets/js/112.c39d2863.js"><link rel="prefetch" href="/assets/js/113.d99548c5.js"><link rel="prefetch" href="/assets/js/114.bf345b4d.js"><link rel="prefetch" href="/assets/js/115.b23c8d7f.js"><link rel="prefetch" href="/assets/js/116.f261e160.js"><link rel="prefetch" href="/assets/js/117.e047cfdc.js"><link rel="prefetch" href="/assets/js/118.32a72d45.js"><link rel="prefetch" href="/assets/js/119.9ed05774.js"><link rel="prefetch" href="/assets/js/12.4e60e234.js"><link rel="prefetch" href="/assets/js/120.e01581ed.js"><link rel="prefetch" href="/assets/js/121.155018a4.js"><link rel="prefetch" href="/assets/js/122.89393b9a.js"><link rel="prefetch" href="/assets/js/123.cf0cbeba.js"><link rel="prefetch" href="/assets/js/124.a8fd43b9.js"><link rel="prefetch" href="/assets/js/125.fe8f56b6.js"><link rel="prefetch" href="/assets/js/126.83d8abe7.js"><link rel="prefetch" href="/assets/js/127.4909dad4.js"><link rel="prefetch" href="/assets/js/128.4d4c1233.js"><link rel="prefetch" href="/assets/js/129.ec6b0c3f.js"><link rel="prefetch" href="/assets/js/13.d016a94b.js"><link rel="prefetch" href="/assets/js/130.9dd3013d.js"><link rel="prefetch" href="/assets/js/131.72fb40bc.js"><link rel="prefetch" href="/assets/js/132.0daf89ff.js"><link rel="prefetch" href="/assets/js/133.09c74c90.js"><link rel="prefetch" href="/assets/js/134.80ca0050.js"><link rel="prefetch" href="/assets/js/135.5492b787.js"><link rel="prefetch" href="/assets/js/136.3c583240.js"><link rel="prefetch" href="/assets/js/137.41085d43.js"><link rel="prefetch" href="/assets/js/138.106e7346.js"><link rel="prefetch" href="/assets/js/139.de3b7cc2.js"><link rel="prefetch" href="/assets/js/14.fcb20a69.js"><link rel="prefetch" href="/assets/js/140.471c1d25.js"><link rel="prefetch" href="/assets/js/141.32e82731.js"><link rel="prefetch" href="/assets/js/142.c45d5556.js"><link rel="prefetch" href="/assets/js/143.8e4e7c83.js"><link rel="prefetch" href="/assets/js/144.ce62f486.js"><link rel="prefetch" href="/assets/js/145.2007b091.js"><link rel="prefetch" href="/assets/js/146.2923ac4c.js"><link rel="prefetch" href="/assets/js/147.d0669d32.js"><link rel="prefetch" href="/assets/js/148.32691045.js"><link rel="prefetch" href="/assets/js/149.f0bcf1b6.js"><link rel="prefetch" href="/assets/js/15.062b0bf8.js"><link rel="prefetch" href="/assets/js/150.089c1a71.js"><link rel="prefetch" href="/assets/js/151.8cf27232.js"><link rel="prefetch" href="/assets/js/152.ac696039.js"><link rel="prefetch" href="/assets/js/153.9de39124.js"><link rel="prefetch" href="/assets/js/154.d7bfd917.js"><link rel="prefetch" href="/assets/js/155.37f62010.js"><link rel="prefetch" href="/assets/js/156.12286d0a.js"><link rel="prefetch" href="/assets/js/157.c29a08d2.js"><link rel="prefetch" href="/assets/js/158.11b1a83e.js"><link rel="prefetch" href="/assets/js/159.9ff4f974.js"><link rel="prefetch" href="/assets/js/16.6bbba090.js"><link rel="prefetch" href="/assets/js/160.df77542c.js"><link rel="prefetch" href="/assets/js/161.4791a222.js"><link rel="prefetch" href="/assets/js/162.022bf211.js"><link rel="prefetch" href="/assets/js/163.91a6d4dd.js"><link rel="prefetch" href="/assets/js/164.76c8e386.js"><link rel="prefetch" href="/assets/js/165.aafad44f.js"><link rel="prefetch" href="/assets/js/166.8bf52bf5.js"><link rel="prefetch" href="/assets/js/167.3316cd81.js"><link rel="prefetch" href="/assets/js/168.9ab5454a.js"><link rel="prefetch" href="/assets/js/169.cb768d4f.js"><link rel="prefetch" href="/assets/js/17.a9681adb.js"><link rel="prefetch" href="/assets/js/170.5ee06f92.js"><link rel="prefetch" href="/assets/js/171.fd901cef.js"><link rel="prefetch" href="/assets/js/172.9edeb495.js"><link rel="prefetch" href="/assets/js/173.61d9b634.js"><link rel="prefetch" href="/assets/js/174.bbdd3929.js"><link rel="prefetch" href="/assets/js/175.38d5cea0.js"><link rel="prefetch" href="/assets/js/176.bef1634d.js"><link rel="prefetch" href="/assets/js/177.abf795a9.js"><link rel="prefetch" href="/assets/js/178.b9bd9ca9.js"><link rel="prefetch" href="/assets/js/179.c403e51b.js"><link rel="prefetch" href="/assets/js/18.d748ff12.js"><link rel="prefetch" href="/assets/js/180.d5119015.js"><link rel="prefetch" href="/assets/js/181.510f48c7.js"><link rel="prefetch" href="/assets/js/182.8a437fea.js"><link rel="prefetch" href="/assets/js/183.b380dc7b.js"><link rel="prefetch" href="/assets/js/184.eb1815f0.js"><link rel="prefetch" href="/assets/js/185.633404f3.js"><link rel="prefetch" href="/assets/js/186.07f01b4d.js"><link rel="prefetch" href="/assets/js/187.3e11484f.js"><link rel="prefetch" href="/assets/js/188.49c46a00.js"><link rel="prefetch" href="/assets/js/189.73c85410.js"><link rel="prefetch" href="/assets/js/19.ac459848.js"><link rel="prefetch" href="/assets/js/190.78098d26.js"><link rel="prefetch" href="/assets/js/191.a9e38184.js"><link rel="prefetch" href="/assets/js/192.f874346b.js"><link rel="prefetch" href="/assets/js/193.b55eda66.js"><link rel="prefetch" href="/assets/js/194.1fc2c4f4.js"><link rel="prefetch" href="/assets/js/195.7aa4d6ee.js"><link rel="prefetch" href="/assets/js/196.933faa17.js"><link rel="prefetch" href="/assets/js/197.c8a34412.js"><link rel="prefetch" href="/assets/js/198.f5108d64.js"><link rel="prefetch" href="/assets/js/199.3bf0fba7.js"><link rel="prefetch" href="/assets/js/20.aee1f501.js"><link rel="prefetch" href="/assets/js/200.15b157f6.js"><link rel="prefetch" href="/assets/js/201.7a47f778.js"><link rel="prefetch" href="/assets/js/202.55347920.js"><link rel="prefetch" href="/assets/js/203.8edfbade.js"><link rel="prefetch" href="/assets/js/204.416cc55b.js"><link rel="prefetch" href="/assets/js/205.61ffea58.js"><link rel="prefetch" href="/assets/js/206.6b99ab65.js"><link rel="prefetch" href="/assets/js/207.e8f7f1f6.js"><link rel="prefetch" href="/assets/js/208.c595017e.js"><link rel="prefetch" href="/assets/js/209.8f3509cb.js"><link rel="prefetch" href="/assets/js/21.f4a5b57b.js"><link rel="prefetch" href="/assets/js/210.8e5248f3.js"><link rel="prefetch" href="/assets/js/211.d4dbcca8.js"><link rel="prefetch" href="/assets/js/212.5aaf0b00.js"><link rel="prefetch" href="/assets/js/213.900cba80.js"><link rel="prefetch" href="/assets/js/214.01a37f69.js"><link rel="prefetch" href="/assets/js/215.d3ef7a39.js"><link rel="prefetch" href="/assets/js/216.dfc80179.js"><link rel="prefetch" href="/assets/js/217.4d860a68.js"><link rel="prefetch" href="/assets/js/218.9966e5dd.js"><link rel="prefetch" href="/assets/js/219.29339c94.js"><link rel="prefetch" href="/assets/js/22.fe85c967.js"><link rel="prefetch" href="/assets/js/220.4fed1ede.js"><link rel="prefetch" href="/assets/js/221.aeb8e19b.js"><link rel="prefetch" href="/assets/js/222.6c8d678a.js"><link rel="prefetch" href="/assets/js/223.4c0da65e.js"><link rel="prefetch" href="/assets/js/224.8c74fb19.js"><link rel="prefetch" href="/assets/js/225.a68d2e37.js"><link rel="prefetch" href="/assets/js/226.abaefa28.js"><link rel="prefetch" href="/assets/js/227.f59f95c0.js"><link rel="prefetch" href="/assets/js/228.9541fb75.js"><link rel="prefetch" href="/assets/js/229.4f24901d.js"><link rel="prefetch" href="/assets/js/23.8575cf75.js"><link rel="prefetch" href="/assets/js/230.63d67c51.js"><link rel="prefetch" href="/assets/js/231.64608394.js"><link rel="prefetch" href="/assets/js/232.4ce06dd5.js"><link rel="prefetch" href="/assets/js/233.7e5f696c.js"><link rel="prefetch" href="/assets/js/234.ba1e638b.js"><link rel="prefetch" href="/assets/js/235.88ae86d6.js"><link rel="prefetch" href="/assets/js/236.b7b28782.js"><link rel="prefetch" href="/assets/js/237.0e1fa091.js"><link rel="prefetch" href="/assets/js/238.a95a8d82.js"><link rel="prefetch" href="/assets/js/239.9a97ea15.js"><link rel="prefetch" href="/assets/js/24.5082f31f.js"><link rel="prefetch" href="/assets/js/240.8f534467.js"><link rel="prefetch" href="/assets/js/241.0bcac9fc.js"><link rel="prefetch" href="/assets/js/242.fe577e6f.js"><link rel="prefetch" href="/assets/js/243.b305fc3e.js"><link rel="prefetch" href="/assets/js/244.c74e03a2.js"><link rel="prefetch" href="/assets/js/245.aa6e895c.js"><link rel="prefetch" href="/assets/js/246.b754c137.js"><link rel="prefetch" href="/assets/js/247.4b449cea.js"><link rel="prefetch" href="/assets/js/248.b89cc5a5.js"><link rel="prefetch" href="/assets/js/249.db4ec2bd.js"><link rel="prefetch" href="/assets/js/25.9b249ede.js"><link rel="prefetch" href="/assets/js/250.3db5fb88.js"><link rel="prefetch" href="/assets/js/251.28d258db.js"><link rel="prefetch" href="/assets/js/252.99ed64d0.js"><link rel="prefetch" href="/assets/js/253.bae0a664.js"><link rel="prefetch" href="/assets/js/254.1121e509.js"><link rel="prefetch" href="/assets/js/255.d40dffe8.js"><link rel="prefetch" href="/assets/js/256.78eac535.js"><link rel="prefetch" href="/assets/js/257.a9f2faa6.js"><link rel="prefetch" href="/assets/js/258.58e43430.js"><link rel="prefetch" href="/assets/js/259.e5ddfb4d.js"><link rel="prefetch" href="/assets/js/26.c21d7c8c.js"><link rel="prefetch" href="/assets/js/260.a07bd1f6.js"><link rel="prefetch" href="/assets/js/261.b1b2ac9a.js"><link rel="prefetch" href="/assets/js/262.e4603dfa.js"><link rel="prefetch" href="/assets/js/263.5c61f127.js"><link rel="prefetch" href="/assets/js/264.9bb316eb.js"><link rel="prefetch" href="/assets/js/265.7fa6f034.js"><link rel="prefetch" href="/assets/js/266.15429978.js"><link rel="prefetch" href="/assets/js/267.af8fa8cc.js"><link rel="prefetch" href="/assets/js/268.5796912d.js"><link rel="prefetch" href="/assets/js/269.8cd5f37a.js"><link rel="prefetch" href="/assets/js/27.3dab15d0.js"><link rel="prefetch" href="/assets/js/270.13c4fc6f.js"><link rel="prefetch" href="/assets/js/271.06812816.js"><link rel="prefetch" href="/assets/js/272.f44b592f.js"><link rel="prefetch" href="/assets/js/273.23ebba2e.js"><link rel="prefetch" href="/assets/js/274.955888b7.js"><link rel="prefetch" href="/assets/js/275.3c372cef.js"><link rel="prefetch" href="/assets/js/276.adaff8d9.js"><link rel="prefetch" href="/assets/js/277.5b655519.js"><link rel="prefetch" href="/assets/js/278.eb69bdc6.js"><link rel="prefetch" href="/assets/js/279.237ef168.js"><link rel="prefetch" href="/assets/js/28.6a4d3a37.js"><link rel="prefetch" href="/assets/js/280.2559264a.js"><link rel="prefetch" href="/assets/js/281.27b03fe8.js"><link rel="prefetch" href="/assets/js/282.416c5e2e.js"><link rel="prefetch" href="/assets/js/283.fa9dbf1e.js"><link rel="prefetch" href="/assets/js/284.27ecffdf.js"><link rel="prefetch" href="/assets/js/285.a8de0a4c.js"><link rel="prefetch" href="/assets/js/286.9a10e1ee.js"><link rel="prefetch" href="/assets/js/287.d7aa7fb8.js"><link rel="prefetch" href="/assets/js/288.e2fd3e64.js"><link rel="prefetch" href="/assets/js/289.8981a1d7.js"><link rel="prefetch" href="/assets/js/29.f4e34536.js"><link rel="prefetch" href="/assets/js/290.5736d426.js"><link rel="prefetch" href="/assets/js/291.6dad386b.js"><link rel="prefetch" href="/assets/js/292.7bec400a.js"><link rel="prefetch" href="/assets/js/293.4c4e069e.js"><link rel="prefetch" href="/assets/js/294.467bf0e8.js"><link rel="prefetch" href="/assets/js/295.91fbec0c.js"><link rel="prefetch" href="/assets/js/296.da6bb5bb.js"><link rel="prefetch" href="/assets/js/297.6a7d4ee1.js"><link rel="prefetch" href="/assets/js/298.cee259cc.js"><link rel="prefetch" href="/assets/js/299.d992c93c.js"><link rel="prefetch" href="/assets/js/3.e6869fad.js"><link rel="prefetch" href="/assets/js/30.7b469ba2.js"><link rel="prefetch" href="/assets/js/300.142a6323.js"><link rel="prefetch" href="/assets/js/301.f1519c92.js"><link rel="prefetch" href="/assets/js/302.297eb0a5.js"><link rel="prefetch" href="/assets/js/303.ba76629f.js"><link rel="prefetch" href="/assets/js/304.0dabc421.js"><link rel="prefetch" href="/assets/js/305.9c51b1ac.js"><link rel="prefetch" href="/assets/js/306.a82aaaa3.js"><link rel="prefetch" href="/assets/js/307.f3f1877b.js"><link rel="prefetch" href="/assets/js/308.2146a0be.js"><link rel="prefetch" href="/assets/js/309.3848d792.js"><link rel="prefetch" href="/assets/js/31.099a9062.js"><link rel="prefetch" href="/assets/js/310.8fe48a42.js"><link rel="prefetch" href="/assets/js/311.d046f5f8.js"><link rel="prefetch" href="/assets/js/312.980054b0.js"><link rel="prefetch" href="/assets/js/313.8ff2fee3.js"><link rel="prefetch" href="/assets/js/314.82c24d9c.js"><link rel="prefetch" href="/assets/js/315.6806521c.js"><link rel="prefetch" href="/assets/js/316.3d42f375.js"><link rel="prefetch" href="/assets/js/317.470eba2a.js"><link rel="prefetch" href="/assets/js/318.9d5d08f0.js"><link rel="prefetch" href="/assets/js/319.68ea2d79.js"><link rel="prefetch" href="/assets/js/32.048bff68.js"><link rel="prefetch" href="/assets/js/320.eef959d6.js"><link rel="prefetch" href="/assets/js/321.b0a03b10.js"><link rel="prefetch" href="/assets/js/322.b55b3a75.js"><link rel="prefetch" href="/assets/js/323.f47248b5.js"><link rel="prefetch" href="/assets/js/324.e29ef3ca.js"><link rel="prefetch" href="/assets/js/325.d8af0241.js"><link rel="prefetch" href="/assets/js/326.db81a605.js"><link rel="prefetch" href="/assets/js/327.9ba2b830.js"><link rel="prefetch" href="/assets/js/328.8e8510d5.js"><link rel="prefetch" href="/assets/js/329.479a9b1f.js"><link rel="prefetch" href="/assets/js/33.c8f14f88.js"><link rel="prefetch" href="/assets/js/330.80946d22.js"><link rel="prefetch" href="/assets/js/331.eafcf034.js"><link rel="prefetch" href="/assets/js/332.0676a2ea.js"><link rel="prefetch" href="/assets/js/34.8a34d988.js"><link rel="prefetch" href="/assets/js/35.1356cd46.js"><link rel="prefetch" href="/assets/js/36.0098f7b3.js"><link rel="prefetch" href="/assets/js/37.278fd133.js"><link rel="prefetch" href="/assets/js/38.e637498c.js"><link rel="prefetch" href="/assets/js/39.0eb2e7cc.js"><link rel="prefetch" href="/assets/js/4.d0b4519a.js"><link rel="prefetch" href="/assets/js/40.5dd56e15.js"><link rel="prefetch" href="/assets/js/41.8fd63255.js"><link rel="prefetch" href="/assets/js/42.19ffc5e5.js"><link rel="prefetch" href="/assets/js/43.2ca7208b.js"><link rel="prefetch" href="/assets/js/45.effd8f05.js"><link rel="prefetch" href="/assets/js/46.1f2526a4.js"><link rel="prefetch" href="/assets/js/47.e4191409.js"><link rel="prefetch" href="/assets/js/48.e80d7336.js"><link rel="prefetch" href="/assets/js/49.d926d5a5.js"><link rel="prefetch" href="/assets/js/5.7f9a977e.js"><link rel="prefetch" href="/assets/js/50.6377fcaf.js"><link rel="prefetch" href="/assets/js/51.4253dedb.js"><link rel="prefetch" href="/assets/js/52.37343d8c.js"><link rel="prefetch" href="/assets/js/53.29a668b7.js"><link rel="prefetch" href="/assets/js/54.3afc1b90.js"><link rel="prefetch" href="/assets/js/55.801dc94a.js"><link rel="prefetch" href="/assets/js/56.94aae014.js"><link rel="prefetch" href="/assets/js/57.fdab6189.js"><link rel="prefetch" href="/assets/js/58.7ecdef0f.js"><link rel="prefetch" href="/assets/js/59.024d6be5.js"><link rel="prefetch" href="/assets/js/6.b8070ad0.js"><link rel="prefetch" href="/assets/js/60.060309f5.js"><link rel="prefetch" href="/assets/js/61.fc45b397.js"><link rel="prefetch" href="/assets/js/62.2576086f.js"><link rel="prefetch" href="/assets/js/63.b5ed4a5d.js"><link rel="prefetch" href="/assets/js/64.010dd1cc.js"><link rel="prefetch" href="/assets/js/65.7573e372.js"><link rel="prefetch" href="/assets/js/66.8b2aa73e.js"><link rel="prefetch" href="/assets/js/67.ae36c392.js"><link rel="prefetch" href="/assets/js/68.596fb43c.js"><link rel="prefetch" href="/assets/js/69.f5e9e642.js"><link rel="prefetch" href="/assets/js/7.c3172a68.js"><link rel="prefetch" href="/assets/js/70.b5c36b8c.js"><link rel="prefetch" href="/assets/js/71.fb167e4b.js"><link rel="prefetch" href="/assets/js/72.1bc18d14.js"><link rel="prefetch" href="/assets/js/73.8e09fccb.js"><link rel="prefetch" href="/assets/js/74.75b9e4b6.js"><link rel="prefetch" href="/assets/js/75.ad8e9fd4.js"><link rel="prefetch" href="/assets/js/76.76c446fe.js"><link rel="prefetch" href="/assets/js/77.e3a098e9.js"><link rel="prefetch" href="/assets/js/78.cfb1a3c2.js"><link rel="prefetch" href="/assets/js/79.7341b8bf.js"><link rel="prefetch" href="/assets/js/8.e9792fd3.js"><link rel="prefetch" href="/assets/js/80.2343c811.js"><link rel="prefetch" href="/assets/js/81.6b944bfe.js"><link rel="prefetch" href="/assets/js/82.ccb7e6f3.js"><link rel="prefetch" href="/assets/js/83.8d854d94.js"><link rel="prefetch" href="/assets/js/84.a984745c.js"><link rel="prefetch" href="/assets/js/85.34b29c0d.js"><link rel="prefetch" href="/assets/js/86.91ce6cf3.js"><link rel="prefetch" href="/assets/js/87.237a2922.js"><link rel="prefetch" href="/assets/js/88.e8f917ae.js"><link rel="prefetch" href="/assets/js/89.2ab8f7a4.js"><link rel="prefetch" href="/assets/js/9.46996e15.js"><link rel="prefetch" href="/assets/js/90.8e8dfe08.js"><link rel="prefetch" href="/assets/js/91.d63134f1.js"><link rel="prefetch" href="/assets/js/92.fe7b98ea.js"><link rel="prefetch" href="/assets/js/93.96ab2605.js"><link rel="prefetch" href="/assets/js/94.34339f6a.js"><link rel="prefetch" href="/assets/js/95.29d4d582.js"><link rel="prefetch" href="/assets/js/96.cc423b40.js"><link rel="prefetch" href="/assets/js/97.ecbb6511.js"><link rel="prefetch" href="/assets/js/98.2d3fc84a.js"><link rel="prefetch" href="/assets/js/99.89474e28.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2d4b740c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">YuweiYin</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/home/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/article/mathematics/" class="nav-link">
  数学哲学
</a></div><div class="nav-item"><a href="/article/physics/" class="nav-link">
  物理宇宙
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="信息科学" class="dropdown-title"><span class="title">信息科学</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/article/info-technology/computer-science/" class="nav-link">
  计科基础
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/algorithm/" class="nav-link router-link-active">
  算法编程
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/artificial-intelligence/" class="nav-link">
  人工智能
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-crawler/" class="nav-link">
  网络爬虫
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-frontend/" class="nav-link">
  网站前端
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-backend/" class="nav-link">
  网站后端
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-security/" class="nav-link">
  网络安全
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/system-management/" class="nav-link">
  系统管理
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/other/" class="nav-link">
  其它文章
</a></li></ul></div></div><div class="nav-item"><a href="/article/paper-notes/" class="nav-link">
  论文笔记
</a></div><div class="nav-item"><a href="/article/essay/" class="nav-link">
  见闻随笔
</a></div><div class="nav-item"><a href="/article/other/" class="nav-link">
  其它系列
</a></div><div class="nav-item"><a href="/article/reprint/" class="nav-link">
  转载文章
</a></div><div class="nav-item"><a href="https://www.github.com/YuweiYin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/home/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/article/mathematics/" class="nav-link">
  数学哲学
</a></div><div class="nav-item"><a href="/article/physics/" class="nav-link">
  物理宇宙
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="信息科学" class="dropdown-title"><span class="title">信息科学</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/article/info-technology/computer-science/" class="nav-link">
  计科基础
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/algorithm/" class="nav-link router-link-active">
  算法编程
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/artificial-intelligence/" class="nav-link">
  人工智能
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-crawler/" class="nav-link">
  网络爬虫
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-frontend/" class="nav-link">
  网站前端
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-backend/" class="nav-link">
  网站后端
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-security/" class="nav-link">
  网络安全
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/system-management/" class="nav-link">
  系统管理
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/other/" class="nav-link">
  其它文章
</a></li></ul></div></div><div class="nav-item"><a href="/article/paper-notes/" class="nav-link">
  论文笔记
</a></div><div class="nav-item"><a href="/article/essay/" class="nav-link">
  见闻随笔
</a></div><div class="nav-item"><a href="/article/other/" class="nav-link">
  其它系列
</a></div><div class="nav-item"><a href="/article/reprint/" class="nav-link">
  转载文章
</a></div><div class="nav-item"><a href="https://www.github.com/YuweiYin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/article/info-technology/" class="sidebar-link">Information Technology</a></li><li><a href="/article/info-technology/computer-science/" class="sidebar-link">Computer Science</a></li><li><a href="/article/info-technology/algorithm/" class="sidebar-link">Algorithm</a></li><li><a href="/article/info-technology/artificial-intelligence/" class="sidebar-link">Artificial Intelligence</a></li><li><a href="/article/info-technology/web-crawler/" class="sidebar-link">Web Crawler</a></li><li><a href="/article/info-technology/web-frontend/" class="sidebar-link">Web Frontend</a></li><li><a href="/article/info-technology/web-backend/" class="sidebar-link">Web Backend</a></li><li><a href="/article/info-technology/web-security/" class="sidebar-link">Web Security</a></li><li><a href="/article/info-technology/system-management/" class="sidebar-link">System Management</a></li><li><a href="/article/info-technology/other/" class="sidebar-link">Other</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="algorithm-graph-theory-ford-fulkerson"><a href="#algorithm-graph-theory-ford-fulkerson" class="header-anchor">#</a> Algorithm - Graph Theory - Ford-Fulkerson</h1> <p>By <a href="https://yuweiyin.github.io/" target="_blank" rel="noopener noreferrer">YuweiYin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <p>最大流 Max-Flow</p> <p>Ford-Fulkerson 方法</p> <h3 id="流网络"><a href="#流网络" class="header-anchor">#</a> 流网络</h3> <p>流网络 G = (V, E) 是一个有向图，图中每条边 (u, v) \in E 有一个<strong>非负</strong>的<strong>容量值</strong> c(u, v) &gt;= 0。而且，如果边集合 E 包含一条边 (u, v)，则图中不存在反方向的边 (v, u)。如果 (u, v) \notin E，为方便起见，定义 c(u, v) = 0。并且在图中不允许有自循环/自圈 (u, u)。</p> <p>另外，在流网络的所有结点中，有两个特殊的结点：<strong>源结点</strong> s (source) 和<strong>汇点</strong> t (terminal)。源结点入度为 0、汇点出度为 0。为方便起见，假定 V 中每个结点 v 都位于某条从 s 到 v 的路径上，即有 <code>s ~&gt; v ~&gt; t</code> 路径。</p> <p>因此，流网络图是<strong>弱连通</strong>的。并且由于除源结点 s 外的每个结点都至少有一条进入的边，有 <code>|E| &gt;= |V| - 1</code>。</p> <ul><li>流网络的性质主要如下：
<ul><li>流网络 G = (V, E) 是一个弱连通的有向图</li> <li>所有边的权重为非负值，且每条边的权重值有上界 c(u, v)</li> <li>任意两个结点 u, v \in V，不能同时存在边 (u, v) 和边 (v, u)</li> <li>如果某边 (u, v) 不存在，定义其权重值 c(u, v) = 0</li> <li>图中没有自循环 (u, u)</li> <li>通常来说，源结点 s 的入度为 0，汇点 t 的出度为 0</li> <li>每个结点 v 都处于从 s 到 t 的某条路径上。即：从起点 s 发出的流量可以流经 v 到达终点 t</li></ul></li></ul> <p><img src="/img/info-technology/algorithm/graph-theory/max-flow-matching/max-flow-1.png" alt="max-flow-1"></p> <p>这里给出流的形式化定义。设 G = (V, E) 是一个<strong>流网络</strong>，其<strong>容量函数</strong>为 c。设 s 为网络的<strong>源结点</strong>，t 为<strong>汇点</strong>。G 中的<strong>流</strong>是一个<strong>实值函数</strong> f: VxV -&gt; R，满足如下两条性质：</p> <ol><li><strong>容量限制</strong>：（“流量有限额”）对于所有的结点 u, v \in V，要求 0 &lt;= f(u, v) &lt;= c(u, v)</li> <li><strong>流量守恒</strong>：（“流入等于流出”）对于所有的结点 u \in V - {s, t}，要求 $ \sum_{v \in V} f(v, u) = \sum_{v \in V} f(u, v) $
<ul><li>当 (u, v) \notin E 时，从结点 u 到结点 v 之间没有流，因此 f(u, v) == 0</li></ul></li></ol> <p>称非负数值 f(u, v) 为从结点 u 到结点 v 的流。一个流 f 的值 <code>|f|</code> 定义如下：</p> <p>$$ |f| = \sum_{v \in V} f(s, v) = \sum_{v \in V} f(v, s) $$</p> <p>即，流 f 的值时从源结点流出的总流量 减去 流入源结点的总流量。这里符号 <code>|·|</code> 仅用作表达流的值，而不是数的绝对值或者集合的基数值。</p> <p>通常来说，一个流网络不会有任何进入源结点的边，即源结点的入度为 0，故求和项 $ \sum_{v \in V} f(v, s) $ 的值将是 0。但对于有的网络而言（比如<strong>残存网络</strong>），流入源结点的流量十分重要。</p> <p>在<strong>最大流问题</strong>中，给定一个<strong>流网络</strong> G、一个<strong>源结点</strong> s、一个<strong>汇点</strong> t，目标是找到值最大的一个<strong>流</strong>。</p> <h2 id="ford-fulkerson-方法"><a href="#ford-fulkerson-方法" class="header-anchor">#</a> Ford-Fulkerson 方法</h2> <p>常用于解决最大流问题的 Ford-Fulkerson 方法，之所以被称为“方法”而不是“算法”，是因为它主要提供的是一种通用的解决思路，包含了几种运行时间不同的具体算法实现。</p> <p>Ford-Fulkerson 方法依赖于三种重要思想：<strong>残存网络</strong>、<strong>增广路径</strong> 和 <strong>切割</strong>。这三种思想与许多流算法和问题有关，它们是<strong>最大流最小切割定理</strong>（《CLRS》定理 26.6）的精髓。该定理以<strong>流网络的切割</strong>来表述最大流的值。</p> <p>Ford-Fulkerson 方法<strong>循环增加流的值</strong>：</p> <ul><li>在开始的时候，对于所有的结点 u, v \in V，f(u, v) = 0，给出的初始流量为 0。</li> <li>每一次迭代中，将图 G 的流值进行增加，增加的方法就是在一个关联的“残存网络” Gf 中寻找一条“增广路径”
<ul><li>一旦知道图 Gf 中的一条增广路径的边，就可以很容易地辨别出 G 中的一些具体的边，可以对这些边上的流量进行修改，从而增加流的值。</li></ul></li> <li>虽然 Ford-Fulkerson 方法的每次迭代都增加流（整体）的值，但是对于图 G 的一条特定边来说，其流量可能增加，也可能减少。
<ul><li>而且，对某些边的流进行缩减可能是必要的，以便让算法可以将更多的流从源结点发送到汇点。</li></ul></li> <li>重复对流进行这一过程，知道残存网络中不再存在增广路径为止。最大流最小切割定理将说明在算法终结时，该算法将获得一个最大流。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>FORD_FULKERSON_METHOD(G, s, t)
1  initialize flow f to 0
2  while there exists an augmenting path p in the residual network Gf
3      augment flow f along p
4  return f
</code></pre></div><p>为了实现和分析 Ford-Fulkerson 方法，需要引入如下几个新的概念。</p> <h3 id="残存网络"><a href="#残存网络" class="header-anchor">#</a> 残存网络</h3> <p>从直观上看，给定流网络 G 和流量 f，残存网络 Gf 由那些 <strong>仍有空间对流量进行调整的边</strong> 构成。流网络的一条边<strong>可以允许的额外流量</strong>等于 该边的容量 减去 该边上的流量。如果该差值为正，则将该条边置于残存网络图 Gf 中，并将其<strong>残存容量</strong>设置为 cf(u, v) = c(u, v) - f(u, v)。对于图 G 中的边来说，只有能够允许额外流量的边才能被加入到图 Gf 中。如果边 (u, v) 的流量 f(u, v) 等于其容量 c(u, v)，则其 cf(u, v) == 0，该条边将不属于图 Gf。（注意，根据<strong>容量限制</strong>原则，残存容量 cf(u, v) 不可能为负值）</p> <p>残存网络 Gf 中可能包含图 G 中不存在的边。算法对流量进行操作的目标是增加总流量，为此，算法可能对某些特定边上的流量进行缩减，为了表示对一个正流量 f(u, v) 的缩减，将反向边 (v, u) 加入到图 Gf 中，并将其残存容量设置为 cf(v, u) = f(u, v)。即 一条边所能允许的反向流量最多将其正向流量抵消。残存网络中的这些反向边允许算法将已经发送出来的流量发送回去。</p> <p>而将流量从同一条边发送回去等同于<strong>缩减</strong>该条边的流量，这种操作在许多算法中都是必须的。</p> <p>更形式化地说，假定有一个流网络 G = (V, E)，其源结点为 s，汇点为 t。设 f 为图 G 中的一个流，考虑结点对 u, v \in V，定义<strong>残存容量</strong> cf(u, v) 如下：</p> <ul><li>若 (u, v) \in E，则 cf(u, v) = c(u, v) - f(u, v)</li> <li>若 (v, u) \in E，则 cf(u, v) = f(v, u)</li> <li>若是其它情况，则 cf(u, v) = 0</li></ul> <p>由于已经假定在图 G 中边 (u, v) 和边 (v, u) 不能同时出现，故上述三种情况有且仅有一种会发生。</p> <p>举例来说，如果容量限制 c(u, v) = 16，并且当前流量 f(u, v) = 11，则对 f(u, v) 可以增加的量最多为 cf(u, v) = 5，再多就超过边 (u, v) 的容量限制了。同时，允许算法从结点 v 向结点 u 最多返回 11 单位的流量（即全部当前流量），因此残存网络中反向边 cf(v, u) = 11。</p> <hr> <p>给定一个流网络 G = (V, E) 和一个流 f，则由 f 所诱导的图 G 的<strong>残存网络</strong>为 Gf = (V, Ef)，其中边集 Ef = {(u, v) \in V x V: cf(u, v) &gt; 0}</p> <p>即 残存网络的每条边（称为<strong>残存边</strong>），必须允许大于 0 的流量通过。下面图 26-4 中的 (a) 图是前面图 26-1 (b) 的流网络 G 和流量 f 的重新绘制，图 26-4 (b) 描述的是对应的残存网络 Gf。Ef 中的边要么是 E 中原有的边，要么是其反向边，因此有 <code>|Ef| &lt;= 2|E|</code></p> <p><img src="/img/info-technology/algorithm/graph-theory/max-flow-matching/ford-fulkerson-1.png" alt="ford-fulkerson-1"></p> <p>残存网络 Gf 类似于一个容量为 cf 的流网络，但是不满足前面对流网络的定义，因为在 Gf 中可以有反平行边。除了反平行边这个区别外，流网络的其他性质 Gf 都有保留，因此可以在残存网络中定义一个流，它满足流的两条性质：<strong>容量限制</strong> 和 <strong>流量守恒</strong>。该流针对的是残存网络 Gf 中的残存容量 cf。</p> <p>残存网络 Gf 中的一个流指出的是一条<strong>路线图</strong>：如何在原来的流网络 G 中增加流。如果 f 是 G 的一个流，f' 是对应的残存网络 Gf 中的一个流，定义 f↑f' 为流 f' 对流 f 的<strong>递增</strong> (augmentation)，它是一个从 V x V 到 R 的函数，具体定义如下：</p> <ul><li>若 (u, v) \in E，则 (f↑f')(u, v) = f(u, v) + f'(u, v) - f'(v, u)</li> <li>其它情况，则 (f↑f')(u, v) = 0</li></ul> <p>该定义背后的直观解释遵循残存网络的定义。因为在残存网络中<strong>将流量发送到反向边</strong> 等同于 在原来的网络中<strong>缩减流量</strong>，所以将边 (u, v) 的流量增加 f'(u, v)，但减少 f'(v, u)。在残存网络中将流量推送回去 也被称为<strong>抵消操作</strong> (cancellation)。</p> <p>举例来说，如果某公司将 5 箱货物从城市 u 发送到城市 v，同时将 2 箱同样的货物从城市 v 发送到城市 u，那么可以(从整体上来说)等价于 将 3 箱货物从城市 u 发送到城市 v。这类<strong>抵消操作</strong>对于任何<strong>最大流算法</strong>来说都是<strong>非常关键</strong>的。</p> <hr> <p>《CLRS》<strong>引理 26.1</strong>：设 G = (V, E) 为一个流网络，源结点为 s，汇点为 t，设 f 为 G 中的一个流。设 Gf 为由流 f 所诱导的 G 的残存网络，设 f' 为 Gf 中的一个流。那么函数 (f↑f') 是 G 的一个流，其值为 <code>|f↑f'| = |f| + |f'|</code>。</p> <p>对引理 26.1 的证明主要有以下四点（具体证明参考《CLRS》Chapter 26.2）：</p> <ol><li>流量非负：(f↑f')(u, v) &gt;= 0</li> <li>容量限制：(f↑f')(u, v) &lt;= c(u, v)</li> <li>流量守恒：对于所有的结点 u \in V - {s, t}，$ \sum_{v \in V} (f↑f')(u, v) = \sum_{v \in V} (f↑f')(v, u) $</li> <li>计算 (f↑f') 的值，确保 <code>|f↑f'| = |f| + |f'|</code></li></ol> <h3 id="增广路径"><a href="#增广路径" class="header-anchor">#</a> 增广路径</h3> <p>给定流网络 G = (V, E) 和流 f，<strong>增广路径</strong> p 是残存网络 Gf 中一条从源结点 s 到汇点 t 的<strong>简单路径</strong>。根据残存网络的定义，对于一条增广路径上的边 (u, v)，可以增加其流量的幅度 最大为 cf(u, v)，再多会违反容量限制。</p> <p>例如前面 图 26-4 (b) 中阴影覆盖的路径是一条增广路径。如果将图中的残存网络 Gf 看作一个流网络，那么可以对这条路径上的<strong>每条边的流量增加</strong> 4 个单位，而不会违反容量限制，因为该条路径上<strong>最小的残存容量</strong>是 cf(v2, v3) = 4。</p> <p>称在一条增广路径 p 上能够为每条边增加的流量的最大值 为路径 p 的<strong>残存容量</strong>，该容量的表达式为：cf(p) = min{cf(u, v): (u, v) 属于路径 p}。下面的引理更加精确地阐述了此论断：</p> <p>《CLRS》<strong>引理 26.2</strong>：设 G = (V, E) 为一个流网络，设 f 为图 G 中的一个流，设 p 为残存网络 Gf 中的一条增广路径。定义一个函数 fp: V x V -&gt; R 如下：</p> <ul><li>若 (u, v) 在 p 上，则 fp(u, v) = cf(p)</li> <li>若是其它情况，则 fp(u, v) = 0</li></ul> <p>则 fp 是残存网络 Gf 中的一个流，其值为 <code>|fp| = cf(p) &gt; 0</code></p> <hr> <p>下面的推论证明，如果将流 f 增加 fp 的量，则将获得 G 的另一个流，该流的值更加接近最大值。图 26-4 (c) 描述的是对图 26-4 (a) 的流 f 增加图 26-4 (b) 所示的 fp 的量 所获得的结果，而图 26-4 (d) 描述的则是残存网络 Gf。</p> <p>《CLRS》<strong>推论 26.3</strong>：设 G = (V, E) 为一个流网络，设 f 为 G 中的一个流，设 p 为残存网络 Gf 中的一条增广路径。设 fp 由引理 26.2 所定义，假定将 f 增加 fp 的量，则函数 <code>|f↑fp| = |f| + |fp| &gt; |f|</code>。</p> <h3 id="流网络和切割"><a href="#流网络和切割" class="header-anchor">#</a> 流网络和切割</h3> <p>Ford-Fulkerson 方法的核心就是<strong>沿着增广路径重复增加路径上的流量</strong>，直到找到一个最大流为止。稍后证明的<strong>最大流最小切割定理</strong>表明：一个流是最大流 当且仅当 其残存网络不包含任何增广路径。</p> <p>流网络 G = (V, E) 中的一个切割 (S, T) 将结点集合 V 划分为 S 和 T=V-S 两个不相交集合，且使得源结点 s \in S、汇点 t \in T。这类似于最小生成树 MST 中的切割，不过这里是对有向图的切割，而非无向图。</p> <p>若 f 是一个流，则定义横跨切割 (S, T) 的<strong>净流量</strong> f(S, T) 如下：</p> <p>$$ f(S, T) = \sum_{u \in S} \sum_{v \in T} f(u, v) - \sum_{u \in S} \sum_{v \in T} f(v, u) $$</p> <p>切割 (S, T) 的<strong>容量</strong>是：</p> <p>$$ c(S, T) = \sum_{u \in S} \sum_{v \in T} c(u, v) $$</p> <p>一个网络的<strong>最小切割</strong>是整个网络中<strong>容量最小的切割</strong>。</p> <hr> <p>流的定义和切割容量的定义之间不存在对称性，但这种不对称性是有意而为，并且很重要。对于容量来说，只计算从集合 S 发出、进入集合 T 的边的容量，而忽略反方向边上的容量。对于流，考虑的则是从 S 到 T 的总流量 减去 (反方向)从 T 到 S 的流量。</p> <p><img src="/img/info-technology/algorithm/graph-theory/max-flow-matching/ford-fulkerson-2.png" alt="ford-fulkerson-2"></p> <p>下面的引理将证明，对于给定流 f，横跨任何切割的净流量都相同，都等于 <code>|f|</code>，即流的值。</p> <p>《CLRS》<strong>引理 26.4</strong>：设 f 为流网络 G 的一个流，该流网络的源结点为 s，汇点为 t，设 (S, T) 为流网络 G 的<strong>任意切割</strong>，则横跨切割 (S, T) 的净流量为 f(S, T) = <code>|f|</code>。</p> <p>引理 26.4 的如下推论 说明如何使用切割容量来限定一个流的值。</p> <p>《CLRS》<strong>推论 26.5</strong>：流网络 G 中任意流 f 的值不能超过 G 的任意切割的容量。</p> <p>此推论给出的一个直接结论是：<strong>一个流网络中最大流的值不能超过该网络最小切割的容量</strong>。这就是下面要来陈述和证明的非常重要的最大流最小切割定理。该定理表明一个最大流的值 事实上等于一个最小切割的容量。</p> <p>《CLRS》<strong>定理 26.6</strong>（<strong>最大流最小切割定理</strong>）：设 f 为流网络 G = (V, E) 中的一个流，该流网络的源结点为 s，汇点为 t，则下面的条件是等价的：</p> <ol><li>f 是 G 的一个最大流。</li> <li>残存网络 Gf 不包含任何增广路径。
<ul><li>增广路径：残存网络 Gf 中一条从源结点 s 到汇点 t 的简单路径。</li></ul></li> <li>最大流的值 <code>|f|</code> = c(S, T)，其中 (S, T) 是流网络 G 的某个切割。</li></ol> <p><img src="/img/info-technology/algorithm/graph-theory/max-flow-matching/ford-fulkerson-3.png" alt="ford-fulkerson-3"></p> <h2 id="基本的-ford-fulkerson-算法"><a href="#基本的-ford-fulkerson-算法" class="header-anchor">#</a> 基本的 Ford-Fulkerson 算法</h2> <p>在 Ford-Fulkerson 方法的每次迭代中，寻找某条增广路径 p，然后使用 p 来对流 f 进行修改（增加）。正如引理 26.2 和推论 26.3 所示，以 f↑fp 来替换 f，从而获得一个值为 <code>|f| + |fp|</code> 的更大的流。</p> <p>在如下算法实现中，通过为每条边 (u, v) \in E 更新流属性 (u, v).f 来计算流网络 G = (V, E) 中的最大流。如果边 (u, v) \notin E，则设置 (u, v).f = 0。另外，假设流网络各边的容量 c(u, v) 都已经给出，如果边 (u, v) \notin E，则设置 c(u, v) = 0。根据如下式子来计算残存容量 cf(u, v)。代码中的表达式 cf(p) 只是一个临时变量，用于存放路径 p 的残存容量。</p> <ul><li>若 (u, v) \in E，则 cf(u, v) = c(u, v) - f(u, v)</li> <li>若 (v, u) \in E，则 cf(u, v) = f(v, u)</li> <li>若是其它情况，则 cf(u, v) = 0</li></ul> <div class="language- extra-class"><pre class="language-text"><code>FORD_FULKERSON(G, s, t)
1  for each edge(u, v) \in G.E
2      (u, v).f = 0
3  while there exists a path p from s to t in the residual network Gf
4      cf(p) = min { cf(u, v): (u, v) is in path p }
5      for each edge(u, v) in p
6          if (u, v) \in E
7              (u, v).f = (u, v).f + cf(p)
8          else
9              (v, u).f = (v, u).f - cf(p)
</code></pre></div><p><code>FORD_FULKERSON(G, s, t)</code> 算法是对 <code>FORD_FULKERSON_METHOD(G, s, t)</code> 方法的简单扩展。算法流程描述如下：</p> <ol><li>在 1～2 行，将流 f 初始化为 0。</li> <li>在 3～9 行的 while 循环中，重复在残存网络 Gf 中寻找一条增广路径 p，然后使用残存容量 cf(p) 来对路径 p 上的流 f 进行增加。路径 p 上的一条边要么是原来网络中的一条边，要么是原来网络中的边 的反向边。
<ul><li>在 4 行，找出路径 p 中的最小残存容量 cf(u, v)。</li> <li>在 5～9 行的 for 循环中，对路径上 p 的每条边 (u, v) 的流量进行更新。</li> <li>在 6～7 行，如果残存边 (u, v) 是原来流网络中的一条边，则增加其流量 (u, v).f</li> <li>在 8～9 行，如果残存边 (u, v) 不是原来流网络中的一条边，则减少其反向边 (v, u) 流量 (v, u).f</li></ul></li> <li>最后，当 while 循环结束时，不再有增广路径。根据最大流最小切割定理，此时流 f 就是最大流。</li></ol> <h3 id="ford-fulkerson-算法的分析"><a href="#ford-fulkerson-算法的分析" class="header-anchor">#</a> Ford-Fulkerson 算法的分析</h3> <p>Ford-Fulkerson 算法的运行时间取决于算法第 3 行是如何寻找增广路径 p 的。如果使用广度优先搜索 BFS 来寻找增广路径，算法的运行时间是多项式数量级。如果选择不好，<code>FORD_FULKERSON</code> <strong>算法</strong>可能不会终止：流的值会随着后续的递增 (augmentation) 而增加，但它却不一定收敛于最大的流值。</p> <p>另外，只有当变得容量为<strong>无理数</strong>时，<code>FORD_FULKERSON_METHOD</code> <strong>方法</strong>才可能无法终止。下面均假定所选择的任意增广路径 p 和所有的容量 c 都是整数值。在实际情况中，最大流问题中的容量常常都是整数。如果容量为有理数，则可以通过乘以某个系数（或者采用近似值）来将其转换为整数。</p> <hr> <p>如果 f* 表示转换后网络中的一个最大流，则在 <code>FORD_FULKERSON</code> 算法的一个直接实现中，执行第 3～9 行的 while 循环的次数最多为 <code>|f*|</code> 次，因为流量值在每次迭代中至少增加一个单位。</p> <p>如果用于实现流网络 G = (V, E) 的数据结构是合理的，并且寻找一条增广路径 p 的算法时间是线性的（比如 DFS 和 BFS），则整个 while 循环的执行将非常高效。假设有一个与有向图 G' = (V, E') 相对应的数据结构，这里 E' = {(u, v): (u, v) \in E 或者 (v, u) \in E}。网络 G 中的边也是网络 G' 中的边，因此在这一数据结构中，保持其容量和流就非常简单了。给定网络 G 的一个流 f，残存网络 Gf 中的边由网络 G' 中所有满足条件 cf(u, v) &gt; 0 的边 (u, v) 所构成，其中 cf 遵守前述残存容量的性质。</p> <p>因此，如果使用深度优先搜索 DFS 或广度优先搜索 BFS，在一个残存网络中找到一条路径的时间应是 <code>O(|V| + |E'|) = O(|E|)</code>。而 while 循环的每一遍执行所需的时间因此为 <code>O(|E|)</code>，这与算法第 1～2 行的初始化成本一样，从而整个 <code>FORD_FULKERSON</code> 算法的运行时间为 <code>O(|E|·|f*|)</code>。</p> <p><img src="/img/info-technology/algorithm/graph-theory/max-flow-matching/ford-fulkerson-4.png" alt="ford-fulkerson-4"></p> <p><img src="/img/info-technology/algorithm/graph-theory/max-flow-matching/ford-fulkerson-5.png" alt="ford-fulkerson-5"></p> <p>当容量都是整数值且最优的流量值 <code>|f*|</code> 较小时，<code>FORD_FULKERSON</code> 算法的运行时间相等不错。但当最优流量值 <code>|f*|</code> 取值较大时，可能会效率很慢，如图 26-7 示例。</p> <p><img src="/img/info-technology/algorithm/graph-theory/max-flow-matching/ford-fulkerson-6.png" alt="ford-fulkerson-6"></p> <h2 id="edmonds-karp-算法"><a href="#edmonds-karp-算法" class="header-anchor">#</a> Edmonds-Karp 算法</h2> <p>可以通过在 <code>FORD_FULKERSON</code> 算法第 3 行寻找增广路径 p 的操作中 使用广度优先搜索 BFS 来改善算法的效率。即 在残存网络中选择的增广路径是一条从源结点 s 到汇点 t 的(无权重)最短路径，BFS 时每条边的权重均为单位距离。称如此实现的 Ford-Fulkerson 方法为 Edmonds-Karp 算法，其运行时间为 <code>O(|V|·|E|^2)</code>，这就与最优流量值 <code>|f*|</code> 的取值大小无关了。</p> <p>对 Edmonds-Karp 算法的分析取决于残存网络 Gf 中结点之间的距离。下面的引理使用符号 df(u, v) 来表示残存网络 Gf 中从结点 u 到结点 v 的(无权重)最短路径距离，其中每条边的权重为单位距离。</p> <p>《CLRS》<strong>引理 26.7</strong>：如果 Edmonds-Karp 算法运行在流网络 G = (V, E) 上，该网络的源结点为 s、汇点为 t，则对于所有的结点 v \in V-{s, t}，残存网络 Gf 中<strong>最短路径距离</strong> df(u, v) 随着每次流量的递增 而<strong>单调递增</strong>。</p> <p>下面的定理给出了 Edmonds-Karp 算法的迭代次数的上界。</p> <p>《CLRS》<strong>定理 26.8</strong>：如果 Edmonds-Karp 算法运行在源结点为 s、汇点为 t 的流网络 G = (V, E) 上，则该算法所执行的流量递增操作的总次数为 <code>O(|V|·|E|)</code>。</p> <p><img src="/img/info-technology/algorithm/graph-theory/max-flow-matching/ford-fulkerson-7.png" alt="ford-fulkerson-7"></p> <p>由于在用广度优先搜索 BFS 寻找增广路径时，<code>FORD_FULKERSON(G, s, t)</code> 中的每次迭代可以在 <code>O(|E|)</code> 时间内实现，所以 Edmonds-Karp 算法的总运行时间为 <code>O(|V|·|E|^2)</code>。</p> <p>而<strong>推送-重贴标签</strong>算法能够取得更好的界，可以达到 <code>O(|V|^2·|E|)</code> 甚至 <code>O(|V|^3)</code>。</p> <h2 id="最大二分匹配"><a href="#最大二分匹配" class="header-anchor">#</a> 最大二分匹配</h2> <p>一些组合问题可以很容易地标注为最大流问题，例如多源结点多汇点的最大流问题。其它一些组合问题在表面上看似与流网络没有什么关系，但实际上却能够归约到最大流问题，比如<strong>最大二分匹配</strong>问题：在一个二分图(或称“二部图”)中找出一个最大匹配。</p> <p>解决此问题 将用到由 Ford-Fulkerson 方法所提供的完整性性质 (integrality property)。使用 Ford-Fulkerson 方法能够在 <code>O(|V|·|E|)</code> 时间内解决图 G = (V, E) 的最大二分匹配问题。</p> <h3 id="最大二分匹配问题"><a href="#最大二分匹配问题" class="header-anchor">#</a> 最大二分匹配问题</h3> <p>二分图的最大匹配 (Bipartite Graph Maximum Matching)</p> <p>给定一个<strong>无向图</strong> G = (V, E)，一个<strong>匹配</strong> (match) 是边的一个子集 $ M \subseteq E $，使得对于所有结点 v \in V，子集 M 中<strong>最多有一条边</strong>与结点 v 关联。如果子集 M 中的某条边与结点 v 关联，则称结点 v <strong>由 M 所匹配</strong>；否则，结点 v 就是<strong>没有匹配</strong>的。<strong>最大匹配</strong>是具有<strong>最大基数</strong>的边集 M。这里的“最大”也是“极大”的意思。</p> <p>最大匹配问题不仅限于 二分图，即两类事物的最大匹配，而是可以在 n 分图 (n &gt;= 2) 上寻找最大匹配。而二分图的匹配是其中最基础的，也最具有代表性。</p> <p>在一个二分图中，结点集合 V 有划分 {L, R}，并且边集合 E 中所有的边都横跨 L 和 R。即：任意边 (u, v) \in E，要么 u \in L 且 v \in R，要么 u \in R 且 v in L。进一步假定无向图 G 是<strong>连通</strong>的，因此 V 中的每个结点至少关联了一条边。</p> <p><img src="/img/info-technology/algorithm/graph-theory/max-flow-matching/bipartite-graph-maximum-matching-1.png" alt="bipartite-graph-maximum-matching-1"></p> <p>在二分图中寻找最大匹配问题有许多实际的应用。例如，把一个机器集合 L 和待执行的任务集合 R 相匹配。E 中有边 (u, v) 就说明机器 u \in L 能够完成任务 v \in R。最大匹配能够让尽可能多的机器同时运行。</p> <p>最大二分匹配问题仅需匹配的基数越大越好，因此边的权重都设定为单位权重，即无权图。但如果考虑边的权重，则可以建模更多的场景，如果在带权图中 希望匹配的总权重值最高，则是最佳匹配的问题了。</p> <h3 id="寻找最大二分匹配"><a href="#寻找最大二分匹配" class="header-anchor">#</a> 寻找最大二分匹配</h3> <p>使用 Ford-Fulkerson 方法可以在 <code>O(|V|·|E|)</code> 时间内找出(无权)无向二分图 G = (V, E) 的最大匹配。解决这一问题的关键技巧是增加额外的源结点 s 和汇点 t，构造出一个流网络，其中的流对应于匹配，如图 26-8 (c) 所示。</p> <p>将二分图 G 所对应的流网络 G' = (V', E') 定义如下：设源结点 s 和汇点 t 为原本不属于结点集合 V 的新结点，并设 V' = V \cup {s, t}。如果图 G 的结点集划分为 V = L \cup R，则 E 中所有从 L 指向 R 的边都是流网络 G' 的边。此外 G' 中的边还包括 <code>|V|</code> 条新的有向边。E' = {(s, u): u \in L} \cup E \cup {(v, t): v \in R}</p> <p>最后，给 E' 中的每条边赋予<strong>单位容量</strong>。由于结点集 V 中的每个结点至少有一条相连的边，<code>|E &gt;= |V| / 2</code>。因此 <code>|E| &lt;= |E'| = |E| + |V| &lt;= 3 |E|</code>，所以 <code>|E'| = \Theta(|E|)</code>。</p> <p>下面的引理证明了图 G 中的一个匹配直接对应 G 所对应的流网络 G' 中的一个流。对于流网络 G = (V, E) 中的一个流 f 来说，如果对于所有的边 (u, v) \in V x V，f(u, v) 都是整数值，则称流 f 是<strong>整数值</strong>的。</p> <p>《CLRS》<strong>引理 26.9</strong>：设 G = (V, E) 为一个二分图，其结点划分为 V = L \cup R，设 G' = (V', E') 是图 G 所对应的流网络。如果 M 是 G 中的一个匹配，则流网络 G' 中存在一个整数值的流 f，使得 <code>|f| = |M|</code>。相反，如果 f 是 G' 中的一个整数值的流，则图 G 中存在一个匹配 M，使得 <code>|M| = |f|</code>。</p> <p>基于引理 26.9，希望得出如下结论：二分图 G 中的一个最大匹配对应于流网络 G' 中的一个最大流，并且可以通过在流网络 G' 上运行一个最大流算法来计算出图 G 中的最大匹配。此结论的得来 存在的唯一障碍是：最大流算法可能返回流网络 G' 中一个非整数的流 f(u, v)，即便流的值 <code>|f|</code> 本身必须是整数。不过，下面的定理将说明，如果使用 Ford-Fulkerson 方法，前述问题不会发生，因此前述结论能够成立。</p> <p>《CLRS》<strong>定理 26.10</strong>（<strong>完整性定理</strong>）：如果容量函数 c 只能取整数值，则 Ford-Fulkerson 方法所生成的最大流 f 满足 <code>|f|</code> 是整数值的性质。而且，对于所有的结点 u 和 v，f(u, v) 的值都是整数。</p> <p>定理 26.10 可以通过对迭代次数进行归纳来证明。下面给出引理 26.9 的一个推论：</p> <p>《CLRS》<strong>推论 26.11</strong>：二分图 G 中的一个最大匹配 M 的基数 等于 其对应的流网络 G' 中某一最大流 f 的值。</p> <p>因此，给定一个无向二分图 G，可以通过创建流网络 G'，在其上运行 Ford-Fulkerson 方法来找到一个最大匹配。这个最大匹配 M 可以直接从找到的整数最大流 f 中获得。由于二分图中任何匹配的基数最大值为 min(L, R) = <code>O(|V|)</code>，G' 中最大流的值为 <code>O(|V|)</code>。又由于 <code>|E'| = \Theta(|E|)</code>，所以可以在 <code>O(|V|·|E'|) = O(|V|·|E|)</code> 时间内找到一个二分图的最大匹配。</p> <h3 id="hopcroft-karp-最大二分匹配算法"><a href="#hopcroft-karp-最大二分匹配算法" class="header-anchor">#</a> Hopcroft-Karp 最大二分匹配算法</h3> <p>目前最快的解决最大二分匹配问题的算法是由 Hopcroft 和 Karp[176] 所发明的，其运行时间为 <code>O(|E|·\sqrt(|V|))</code></p> <p>[176] John E. Hopcroft and Richard M. Karp. An n^{5/2} algorithm for maximum matchings in biparite graphs. <em>SIAM Journal on Computing</em>, 2(4):225-231, 1973.</p> <p>给定一个无向二分图 G = (V, E)，其中 V = L \cup R 并且所有的边都恰有一个端点在集合 L 中，而另一个端点在集合 R 中。设 M 为图 G 的一个匹配。</p> <p>对于图 G 中的一条简单路径 P，如果该路径的起点是 L 中一个未匹配的结点，终结点是集合 R 中的一个未匹配的结点，而路径上的边交替属于 M 和 E-M，则称路径 P 是一条相对于 M 的增广路径（此增广路径的定义与流网络中的增广路径相关，但并不相同）。</p> <p>在这里，将一条路径看作是一系列的边，而不是一系列的结点。一条关于匹配 M 的最短增广路径是一条包含最少边数的增广路径。</p> <p>给定两个集合 A 和 B，<strong>对称差</strong> A \oplus B 定义为 (A-B) \cup (B-A)，即仅在一个集合中出现的元素。</p> <p>详见《CLRS》思考题 26-6</p> <h3 id="完全匹配"><a href="#完全匹配" class="header-anchor">#</a> 完全匹配</h3> <p><strong>完全匹配</strong>是指图中所有的结点都得到匹配的匹配。设 G = (V, E) 是结点划分为 V = L \cup R 的无向二分图，其中 <code>|L| == |R|</code>。对于任意结点子集 $ X \subseteq V $，定义 X 的<strong>邻居</strong>为：N(X) = {y \in V: 对某个 x \in X，(x, y) \in E}，即由与集合 X 中的元素 相邻的结点所构成的集合。</p> <p>关于完全匹配，有 <strong>Hall 定理</strong>：图 G 中存在一个完全匹配 当且仅当 对于每个边子集 $ A \subseteq L $，有 <code>|A| &lt;= |N(A)|</code>。</p> <h3 id="d-正则"><a href="#d-正则" class="header-anchor">#</a> d 正则</h3> <p>对于一个结点划分为 V = L \cup R 的无向二分图 G = (V, E) 而言，如果每个属于结点集合 V 的结点 v 的度数都是自然数 d，则称该二分图是 <strong>d 正则的</strong>。对于每个 d 正则的二分图，都有 <code>|L| == |R|</code>。</p> <p>可以证明：每个 d 正则二分图的匹配基数都是 <code>|L|</code>。</p> <p>证明思路：该二分图对应的流网络的一个最小切割的容量为 <code>|L|</code>。</p> <h2 id="python-代码范例"><a href="#python-代码范例" class="header-anchor">#</a> Python 代码范例</h2> <p>Python 环境：Python 3.7</p> <h3 id="ford-fulkerson-最大流算法"><a href="#ford-fulkerson-最大流算法" class="header-anchor">#</a> Ford-Fulkerson 最大流算法</h3> <ul><li>Ford-Fulkerson 方法
<ul><li>Ford-Fulkerson 算法 O(V |f*|)</li> <li>Edmonds-Karp 算法 O(V E^2)</li></ul></li> <li>Push-Relabel 推送-重贴标签方法
<ul><li>Push-Relabel 通用的推送-重贴标签算法 O(V^2 E)</li> <li>Relabel-To-Front 前置重贴标签算法 O(V^3)</li></ul></li></ul> <p><a href="https://github.com/YuweiYin/Code_Play/blob/master/Algorithm-Essence/graph-theory/max-flow-matching/ford-fulkerson.py" target="_blank" rel="noopener noreferrer">GitHub Code Link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ul><li>Introduction to Algorithm (aka CLRS) Third Edition - Chapter 26</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.07d900b0.js" defer></script><script src="/assets/js/2.5e710586.js" defer></script><script src="/assets/js/44.b6926593.js" defer></script>
  </body>
</html>
