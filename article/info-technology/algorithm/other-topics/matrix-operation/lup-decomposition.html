<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Algorithm - Matrix Operation - LUP Decomposition | YuweiYin</title>
    <meta name="description" content="Homepage of YuweiYin">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="/img/YuweiYin.jpeg">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.2d4b740c.css" as="style"><link rel="preload" href="/assets/js/app.338776d8.js" as="script"><link rel="preload" href="/assets/js/2.5e710586.js" as="script"><link rel="preload" href="/assets/js/76.c65d8991.js" as="script"><link rel="prefetch" href="/assets/js/10.f967ec33.js"><link rel="prefetch" href="/assets/js/100.a918bf34.js"><link rel="prefetch" href="/assets/js/101.e464ffed.js"><link rel="prefetch" href="/assets/js/102.3a55cd96.js"><link rel="prefetch" href="/assets/js/103.d7e285df.js"><link rel="prefetch" href="/assets/js/104.6f9034d1.js"><link rel="prefetch" href="/assets/js/105.567bcf9a.js"><link rel="prefetch" href="/assets/js/106.36477351.js"><link rel="prefetch" href="/assets/js/107.d93634dd.js"><link rel="prefetch" href="/assets/js/108.6a65eea8.js"><link rel="prefetch" href="/assets/js/109.3f687204.js"><link rel="prefetch" href="/assets/js/11.5b164cb4.js"><link rel="prefetch" href="/assets/js/110.b4dc8ef9.js"><link rel="prefetch" href="/assets/js/111.140ef49f.js"><link rel="prefetch" href="/assets/js/112.aa9132ca.js"><link rel="prefetch" href="/assets/js/113.386e4b2c.js"><link rel="prefetch" href="/assets/js/114.2be7cae4.js"><link rel="prefetch" href="/assets/js/115.b726cf6d.js"><link rel="prefetch" href="/assets/js/116.ee059642.js"><link rel="prefetch" href="/assets/js/117.7f774cdf.js"><link rel="prefetch" href="/assets/js/118.74b6de68.js"><link rel="prefetch" href="/assets/js/119.d512e6f3.js"><link rel="prefetch" href="/assets/js/12.61fdaa73.js"><link rel="prefetch" href="/assets/js/120.47edd6d3.js"><link rel="prefetch" href="/assets/js/121.31ec9f51.js"><link rel="prefetch" href="/assets/js/122.30351000.js"><link rel="prefetch" href="/assets/js/123.aa02cb94.js"><link rel="prefetch" href="/assets/js/124.c1f764cf.js"><link rel="prefetch" href="/assets/js/125.0524501e.js"><link rel="prefetch" href="/assets/js/126.6d80204b.js"><link rel="prefetch" href="/assets/js/127.dcf117ed.js"><link rel="prefetch" href="/assets/js/128.69bc2470.js"><link rel="prefetch" href="/assets/js/129.c7de5e6a.js"><link rel="prefetch" href="/assets/js/13.13423942.js"><link rel="prefetch" href="/assets/js/130.107a0d2d.js"><link rel="prefetch" href="/assets/js/131.1df56ec0.js"><link rel="prefetch" href="/assets/js/132.6756aacd.js"><link rel="prefetch" href="/assets/js/133.983902dd.js"><link rel="prefetch" href="/assets/js/134.9835e6be.js"><link rel="prefetch" href="/assets/js/135.c29a8913.js"><link rel="prefetch" href="/assets/js/136.fa35ed67.js"><link rel="prefetch" href="/assets/js/137.1a084d2e.js"><link rel="prefetch" href="/assets/js/138.9c6c6a83.js"><link rel="prefetch" href="/assets/js/139.8874f356.js"><link rel="prefetch" href="/assets/js/14.e2fb8aa6.js"><link rel="prefetch" href="/assets/js/140.2777cfc0.js"><link rel="prefetch" href="/assets/js/141.00c1d847.js"><link rel="prefetch" href="/assets/js/142.3a601367.js"><link rel="prefetch" href="/assets/js/143.a8a9824f.js"><link rel="prefetch" href="/assets/js/144.12e4e356.js"><link rel="prefetch" href="/assets/js/145.38b61aa5.js"><link rel="prefetch" href="/assets/js/146.219cd70a.js"><link rel="prefetch" href="/assets/js/147.ac4650a8.js"><link rel="prefetch" href="/assets/js/148.0511156f.js"><link rel="prefetch" href="/assets/js/149.c1c22b39.js"><link rel="prefetch" href="/assets/js/15.7f07769f.js"><link rel="prefetch" href="/assets/js/150.c5eaaa68.js"><link rel="prefetch" href="/assets/js/151.03599ce7.js"><link rel="prefetch" href="/assets/js/152.fcd974ce.js"><link rel="prefetch" href="/assets/js/153.9091e45c.js"><link rel="prefetch" href="/assets/js/154.6c7ccc17.js"><link rel="prefetch" href="/assets/js/155.16c47efe.js"><link rel="prefetch" href="/assets/js/156.ffe70d22.js"><link rel="prefetch" href="/assets/js/157.436c00ba.js"><link rel="prefetch" href="/assets/js/158.9d96045c.js"><link rel="prefetch" href="/assets/js/159.689c9ddf.js"><link rel="prefetch" href="/assets/js/16.5a323c58.js"><link rel="prefetch" href="/assets/js/160.edda7049.js"><link rel="prefetch" href="/assets/js/161.62badf8c.js"><link rel="prefetch" href="/assets/js/162.abfe29b2.js"><link rel="prefetch" href="/assets/js/163.09214f3c.js"><link rel="prefetch" href="/assets/js/164.03d8ae33.js"><link rel="prefetch" href="/assets/js/165.3b9d5941.js"><link rel="prefetch" href="/assets/js/166.b9a8cc51.js"><link rel="prefetch" href="/assets/js/167.dc295c17.js"><link rel="prefetch" href="/assets/js/168.b4447c67.js"><link rel="prefetch" href="/assets/js/169.f5298f65.js"><link rel="prefetch" href="/assets/js/17.f35473d0.js"><link rel="prefetch" href="/assets/js/170.cc46837a.js"><link rel="prefetch" href="/assets/js/171.b8e0bc09.js"><link rel="prefetch" href="/assets/js/172.1f3e9b4c.js"><link rel="prefetch" href="/assets/js/173.ad3c19e4.js"><link rel="prefetch" href="/assets/js/174.3c39a927.js"><link rel="prefetch" href="/assets/js/175.c85abbec.js"><link rel="prefetch" href="/assets/js/176.d55e245e.js"><link rel="prefetch" href="/assets/js/177.6cb7185e.js"><link rel="prefetch" href="/assets/js/178.9e614d32.js"><link rel="prefetch" href="/assets/js/179.2181acfc.js"><link rel="prefetch" href="/assets/js/18.02dc7ab7.js"><link rel="prefetch" href="/assets/js/180.c090d601.js"><link rel="prefetch" href="/assets/js/181.91db370b.js"><link rel="prefetch" href="/assets/js/182.6eada193.js"><link rel="prefetch" href="/assets/js/183.12cd6d4a.js"><link rel="prefetch" href="/assets/js/184.1ccc4713.js"><link rel="prefetch" href="/assets/js/185.d14590c1.js"><link rel="prefetch" href="/assets/js/186.5dd557ed.js"><link rel="prefetch" href="/assets/js/187.d2e17b0d.js"><link rel="prefetch" href="/assets/js/188.7aafe1eb.js"><link rel="prefetch" href="/assets/js/189.8aceef41.js"><link rel="prefetch" href="/assets/js/19.f64226cb.js"><link rel="prefetch" href="/assets/js/190.c9b1c15b.js"><link rel="prefetch" href="/assets/js/191.70606a81.js"><link rel="prefetch" href="/assets/js/192.05bd6ea2.js"><link rel="prefetch" href="/assets/js/193.e9cdf591.js"><link rel="prefetch" href="/assets/js/194.ebf27382.js"><link rel="prefetch" href="/assets/js/195.54482430.js"><link rel="prefetch" href="/assets/js/196.35bffb17.js"><link rel="prefetch" href="/assets/js/197.5914d2e6.js"><link rel="prefetch" href="/assets/js/198.5e69d743.js"><link rel="prefetch" href="/assets/js/199.dadae2e8.js"><link rel="prefetch" href="/assets/js/20.b665ce81.js"><link rel="prefetch" href="/assets/js/200.917da530.js"><link rel="prefetch" href="/assets/js/201.d3d3d6bd.js"><link rel="prefetch" href="/assets/js/202.6604d2ed.js"><link rel="prefetch" href="/assets/js/203.f6bd1db4.js"><link rel="prefetch" href="/assets/js/204.e7aafd59.js"><link rel="prefetch" href="/assets/js/205.908acc95.js"><link rel="prefetch" href="/assets/js/206.97772be9.js"><link rel="prefetch" href="/assets/js/207.5216da83.js"><link rel="prefetch" href="/assets/js/208.d017221c.js"><link rel="prefetch" href="/assets/js/209.33870b33.js"><link rel="prefetch" href="/assets/js/21.c65c1870.js"><link rel="prefetch" href="/assets/js/210.8daf5510.js"><link rel="prefetch" href="/assets/js/211.f6648c90.js"><link rel="prefetch" href="/assets/js/212.fa602434.js"><link rel="prefetch" href="/assets/js/213.ec9a7b92.js"><link rel="prefetch" href="/assets/js/214.fbffd193.js"><link rel="prefetch" href="/assets/js/215.8f1f172c.js"><link rel="prefetch" href="/assets/js/216.ffe862b7.js"><link rel="prefetch" href="/assets/js/217.bec477c4.js"><link rel="prefetch" href="/assets/js/218.5a6f166d.js"><link rel="prefetch" href="/assets/js/219.bae877e4.js"><link rel="prefetch" href="/assets/js/22.2567d3cf.js"><link rel="prefetch" href="/assets/js/220.094d2873.js"><link rel="prefetch" href="/assets/js/221.fd3e1a1f.js"><link rel="prefetch" href="/assets/js/222.006637e6.js"><link rel="prefetch" href="/assets/js/223.1638798f.js"><link rel="prefetch" href="/assets/js/224.c0b420d7.js"><link rel="prefetch" href="/assets/js/225.3c8aa2c3.js"><link rel="prefetch" href="/assets/js/226.889d304f.js"><link rel="prefetch" href="/assets/js/227.895c2ba6.js"><link rel="prefetch" href="/assets/js/228.29379bcf.js"><link rel="prefetch" href="/assets/js/229.8394d87a.js"><link rel="prefetch" href="/assets/js/23.f741ae26.js"><link rel="prefetch" href="/assets/js/230.98bed704.js"><link rel="prefetch" href="/assets/js/231.eac55cec.js"><link rel="prefetch" href="/assets/js/232.2fc99ed6.js"><link rel="prefetch" href="/assets/js/233.f6369da9.js"><link rel="prefetch" href="/assets/js/234.df156227.js"><link rel="prefetch" href="/assets/js/235.5eadd95d.js"><link rel="prefetch" href="/assets/js/236.6c91ae22.js"><link rel="prefetch" href="/assets/js/237.81746335.js"><link rel="prefetch" href="/assets/js/238.41ce5506.js"><link rel="prefetch" href="/assets/js/239.e4ccf186.js"><link rel="prefetch" href="/assets/js/24.f025ec84.js"><link rel="prefetch" href="/assets/js/240.5ad5cee2.js"><link rel="prefetch" href="/assets/js/241.d6a35d18.js"><link rel="prefetch" href="/assets/js/242.4ff20ec6.js"><link rel="prefetch" href="/assets/js/243.576f20e1.js"><link rel="prefetch" href="/assets/js/244.86fd8409.js"><link rel="prefetch" href="/assets/js/245.4e383f82.js"><link rel="prefetch" href="/assets/js/246.7f1d9e62.js"><link rel="prefetch" href="/assets/js/247.98d0de76.js"><link rel="prefetch" href="/assets/js/248.9cdf71b5.js"><link rel="prefetch" href="/assets/js/249.d4ef6b66.js"><link rel="prefetch" href="/assets/js/25.27544cfc.js"><link rel="prefetch" href="/assets/js/250.0410d925.js"><link rel="prefetch" href="/assets/js/251.c7af59ae.js"><link rel="prefetch" href="/assets/js/252.d61700a3.js"><link rel="prefetch" href="/assets/js/253.37371cdd.js"><link rel="prefetch" href="/assets/js/254.44657697.js"><link rel="prefetch" href="/assets/js/255.7b2525a5.js"><link rel="prefetch" href="/assets/js/256.baf1fff0.js"><link rel="prefetch" href="/assets/js/257.b57f3bf8.js"><link rel="prefetch" href="/assets/js/258.429d4e2f.js"><link rel="prefetch" href="/assets/js/259.51d3b3b6.js"><link rel="prefetch" href="/assets/js/26.c2a925b2.js"><link rel="prefetch" href="/assets/js/260.5f987d68.js"><link rel="prefetch" href="/assets/js/261.00668317.js"><link rel="prefetch" href="/assets/js/262.aa89bef2.js"><link rel="prefetch" href="/assets/js/263.32fa0026.js"><link rel="prefetch" href="/assets/js/264.e4e401a0.js"><link rel="prefetch" href="/assets/js/265.3cc461cc.js"><link rel="prefetch" href="/assets/js/266.0417a9cb.js"><link rel="prefetch" href="/assets/js/267.7990cbee.js"><link rel="prefetch" href="/assets/js/268.6adf55f1.js"><link rel="prefetch" href="/assets/js/269.a88fdbb7.js"><link rel="prefetch" href="/assets/js/27.37b34950.js"><link rel="prefetch" href="/assets/js/270.6a31176d.js"><link rel="prefetch" href="/assets/js/271.40d79711.js"><link rel="prefetch" href="/assets/js/272.427070ea.js"><link rel="prefetch" href="/assets/js/273.f7591e26.js"><link rel="prefetch" href="/assets/js/274.1b456b63.js"><link rel="prefetch" href="/assets/js/275.591b2bd3.js"><link rel="prefetch" href="/assets/js/276.75adb3b6.js"><link rel="prefetch" href="/assets/js/277.a2362c20.js"><link rel="prefetch" href="/assets/js/278.4ee60bb5.js"><link rel="prefetch" href="/assets/js/279.660f4251.js"><link rel="prefetch" href="/assets/js/28.0f4bbb5e.js"><link rel="prefetch" href="/assets/js/280.39730018.js"><link rel="prefetch" href="/assets/js/281.1f32fc88.js"><link rel="prefetch" href="/assets/js/282.a5bc1e6e.js"><link rel="prefetch" href="/assets/js/283.b70797a7.js"><link rel="prefetch" href="/assets/js/284.1fc7d948.js"><link rel="prefetch" href="/assets/js/285.cf03c302.js"><link rel="prefetch" href="/assets/js/286.02e50b29.js"><link rel="prefetch" href="/assets/js/287.02402755.js"><link rel="prefetch" href="/assets/js/288.edbc576e.js"><link rel="prefetch" href="/assets/js/289.fb4cf8c2.js"><link rel="prefetch" href="/assets/js/29.564f8e0e.js"><link rel="prefetch" href="/assets/js/290.2cf26f70.js"><link rel="prefetch" href="/assets/js/291.67580e26.js"><link rel="prefetch" href="/assets/js/292.dce634f4.js"><link rel="prefetch" href="/assets/js/293.d4c1532c.js"><link rel="prefetch" href="/assets/js/294.97bdad35.js"><link rel="prefetch" href="/assets/js/295.01df8642.js"><link rel="prefetch" href="/assets/js/296.95f159ff.js"><link rel="prefetch" href="/assets/js/297.3f2e8cb6.js"><link rel="prefetch" href="/assets/js/298.cd089005.js"><link rel="prefetch" href="/assets/js/299.7fe1a970.js"><link rel="prefetch" href="/assets/js/3.9a9af370.js"><link rel="prefetch" href="/assets/js/30.19956ec4.js"><link rel="prefetch" href="/assets/js/300.82c7e2d5.js"><link rel="prefetch" href="/assets/js/301.cb106109.js"><link rel="prefetch" href="/assets/js/302.f3c6aaaa.js"><link rel="prefetch" href="/assets/js/303.1f5e7dda.js"><link rel="prefetch" href="/assets/js/304.b3f0adcf.js"><link rel="prefetch" href="/assets/js/305.3467aaee.js"><link rel="prefetch" href="/assets/js/306.234e8b08.js"><link rel="prefetch" href="/assets/js/307.9327734b.js"><link rel="prefetch" href="/assets/js/308.3f891bed.js"><link rel="prefetch" href="/assets/js/309.53c5b5d5.js"><link rel="prefetch" href="/assets/js/31.5c51ce08.js"><link rel="prefetch" href="/assets/js/310.175b9ccc.js"><link rel="prefetch" href="/assets/js/311.9045049e.js"><link rel="prefetch" href="/assets/js/312.e3cc54ca.js"><link rel="prefetch" href="/assets/js/313.1c2ab56f.js"><link rel="prefetch" href="/assets/js/314.7aa5ec25.js"><link rel="prefetch" href="/assets/js/315.032a37d0.js"><link rel="prefetch" href="/assets/js/316.4b853264.js"><link rel="prefetch" href="/assets/js/317.ff5483a3.js"><link rel="prefetch" href="/assets/js/318.04d8f96a.js"><link rel="prefetch" href="/assets/js/319.1f08f11e.js"><link rel="prefetch" href="/assets/js/32.c552eab3.js"><link rel="prefetch" href="/assets/js/320.999084a0.js"><link rel="prefetch" href="/assets/js/321.f3d0e77a.js"><link rel="prefetch" href="/assets/js/322.98bd4126.js"><link rel="prefetch" href="/assets/js/323.e12970c8.js"><link rel="prefetch" href="/assets/js/324.f2be1859.js"><link rel="prefetch" href="/assets/js/325.e00aca7c.js"><link rel="prefetch" href="/assets/js/326.59c312d8.js"><link rel="prefetch" href="/assets/js/327.c44080fd.js"><link rel="prefetch" href="/assets/js/328.8e805344.js"><link rel="prefetch" href="/assets/js/329.511f5ab9.js"><link rel="prefetch" href="/assets/js/33.2e71c95d.js"><link rel="prefetch" href="/assets/js/330.c67d354c.js"><link rel="prefetch" href="/assets/js/331.53da0aa4.js"><link rel="prefetch" href="/assets/js/332.884c1bcc.js"><link rel="prefetch" href="/assets/js/333.66688fca.js"><link rel="prefetch" href="/assets/js/334.7784446e.js"><link rel="prefetch" href="/assets/js/34.4715792b.js"><link rel="prefetch" href="/assets/js/35.ca84af36.js"><link rel="prefetch" href="/assets/js/36.c31edebc.js"><link rel="prefetch" href="/assets/js/37.92098954.js"><link rel="prefetch" href="/assets/js/38.ecc049e7.js"><link rel="prefetch" href="/assets/js/39.f61cb78d.js"><link rel="prefetch" href="/assets/js/4.d0b4519a.js"><link rel="prefetch" href="/assets/js/40.f736c71e.js"><link rel="prefetch" href="/assets/js/41.6fad76cf.js"><link rel="prefetch" href="/assets/js/42.66f5c85d.js"><link rel="prefetch" href="/assets/js/43.6110bd5a.js"><link rel="prefetch" href="/assets/js/44.8c2a4521.js"><link rel="prefetch" href="/assets/js/45.447e1b3b.js"><link rel="prefetch" href="/assets/js/46.8a78ee37.js"><link rel="prefetch" href="/assets/js/47.aa58d0b6.js"><link rel="prefetch" href="/assets/js/48.56a4614c.js"><link rel="prefetch" href="/assets/js/49.565287b4.js"><link rel="prefetch" href="/assets/js/5.ee9e9007.js"><link rel="prefetch" href="/assets/js/50.4e663700.js"><link rel="prefetch" href="/assets/js/51.948fce4a.js"><link rel="prefetch" href="/assets/js/52.c9e4e6c6.js"><link rel="prefetch" href="/assets/js/53.05935292.js"><link rel="prefetch" href="/assets/js/54.91c7ce05.js"><link rel="prefetch" href="/assets/js/55.ba07dcf9.js"><link rel="prefetch" href="/assets/js/56.9f99d43e.js"><link rel="prefetch" href="/assets/js/57.a9171b61.js"><link rel="prefetch" href="/assets/js/58.6a6a5be5.js"><link rel="prefetch" href="/assets/js/59.85b399bd.js"><link rel="prefetch" href="/assets/js/6.ac40faf8.js"><link rel="prefetch" href="/assets/js/60.0fb661ef.js"><link rel="prefetch" href="/assets/js/61.40edcedb.js"><link rel="prefetch" href="/assets/js/62.fa853823.js"><link rel="prefetch" href="/assets/js/63.a068397d.js"><link rel="prefetch" href="/assets/js/64.2ced4bc7.js"><link rel="prefetch" href="/assets/js/65.8b482577.js"><link rel="prefetch" href="/assets/js/66.a9e2a128.js"><link rel="prefetch" href="/assets/js/67.4e561d8e.js"><link rel="prefetch" href="/assets/js/68.0b673cf1.js"><link rel="prefetch" href="/assets/js/69.fdbdf778.js"><link rel="prefetch" href="/assets/js/7.3f1ed5cd.js"><link rel="prefetch" href="/assets/js/70.88afc254.js"><link rel="prefetch" href="/assets/js/71.78080656.js"><link rel="prefetch" href="/assets/js/72.ae211912.js"><link rel="prefetch" href="/assets/js/73.64dd0cf6.js"><link rel="prefetch" href="/assets/js/74.4f7419c2.js"><link rel="prefetch" href="/assets/js/75.89400b60.js"><link rel="prefetch" href="/assets/js/77.00a30e67.js"><link rel="prefetch" href="/assets/js/78.579afef9.js"><link rel="prefetch" href="/assets/js/79.a5d0a91b.js"><link rel="prefetch" href="/assets/js/8.e9792fd3.js"><link rel="prefetch" href="/assets/js/80.bae1b070.js"><link rel="prefetch" href="/assets/js/81.813378ea.js"><link rel="prefetch" href="/assets/js/82.e34af38a.js"><link rel="prefetch" href="/assets/js/83.1a9e34b3.js"><link rel="prefetch" href="/assets/js/84.865f324b.js"><link rel="prefetch" href="/assets/js/85.f6a86574.js"><link rel="prefetch" href="/assets/js/86.2fc9ee67.js"><link rel="prefetch" href="/assets/js/87.933bb3b6.js"><link rel="prefetch" href="/assets/js/88.c20736eb.js"><link rel="prefetch" href="/assets/js/89.13947370.js"><link rel="prefetch" href="/assets/js/9.1d1256b9.js"><link rel="prefetch" href="/assets/js/90.9f1b8469.js"><link rel="prefetch" href="/assets/js/91.f8f9ad88.js"><link rel="prefetch" href="/assets/js/92.4756af88.js"><link rel="prefetch" href="/assets/js/93.4d56a2c7.js"><link rel="prefetch" href="/assets/js/94.0500dacc.js"><link rel="prefetch" href="/assets/js/95.78162db3.js"><link rel="prefetch" href="/assets/js/96.ec69af5c.js"><link rel="prefetch" href="/assets/js/97.cc8d35e3.js"><link rel="prefetch" href="/assets/js/98.f3bd6e0f.js"><link rel="prefetch" href="/assets/js/99.c4efab6f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2d4b740c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">YuweiYin</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/home/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/article/mathematics/" class="nav-link">
  数学哲学
</a></div><div class="nav-item"><a href="/article/physics/" class="nav-link">
  物理宇宙
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="信息科学" class="dropdown-title"><span class="title">信息科学</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/article/info-technology/computer-science/" class="nav-link">
  计科基础
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/algorithm/" class="nav-link router-link-active">
  算法编程
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/artificial-intelligence/" class="nav-link">
  人工智能
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-crawler/" class="nav-link">
  网络爬虫
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-frontend/" class="nav-link">
  网站前端
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-backend/" class="nav-link">
  网站后端
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-security/" class="nav-link">
  网络安全
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/system-management/" class="nav-link">
  系统管理
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/other/" class="nav-link">
  其它文章
</a></li></ul></div></div><div class="nav-item"><a href="/article/paper-notes/" class="nav-link">
  论文笔记
</a></div><div class="nav-item"><a href="/article/essay/" class="nav-link">
  见闻随笔
</a></div><div class="nav-item"><a href="/article/other/" class="nav-link">
  其它系列
</a></div><div class="nav-item"><a href="/article/reprint/" class="nav-link">
  转载文章
</a></div><div class="nav-item"><a href="https://www.github.com/YuweiYin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/home/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/article/mathematics/" class="nav-link">
  数学哲学
</a></div><div class="nav-item"><a href="/article/physics/" class="nav-link">
  物理宇宙
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="信息科学" class="dropdown-title"><span class="title">信息科学</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/article/info-technology/computer-science/" class="nav-link">
  计科基础
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/algorithm/" class="nav-link router-link-active">
  算法编程
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/artificial-intelligence/" class="nav-link">
  人工智能
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-crawler/" class="nav-link">
  网络爬虫
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-frontend/" class="nav-link">
  网站前端
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-backend/" class="nav-link">
  网站后端
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/web-security/" class="nav-link">
  网络安全
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/system-management/" class="nav-link">
  系统管理
</a></li><li class="dropdown-item"><!----> <a href="/article/info-technology/other/" class="nav-link">
  其它文章
</a></li></ul></div></div><div class="nav-item"><a href="/article/paper-notes/" class="nav-link">
  论文笔记
</a></div><div class="nav-item"><a href="/article/essay/" class="nav-link">
  见闻随笔
</a></div><div class="nav-item"><a href="/article/other/" class="nav-link">
  其它系列
</a></div><div class="nav-item"><a href="/article/reprint/" class="nav-link">
  转载文章
</a></div><div class="nav-item"><a href="https://www.github.com/YuweiYin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/article/info-technology/" class="sidebar-link">Information Technology</a></li><li><a href="/article/info-technology/computer-science/" class="sidebar-link">Computer Science</a></li><li><a href="/article/info-technology/algorithm/" class="sidebar-link">Algorithm</a></li><li><a href="/article/info-technology/artificial-intelligence/" class="sidebar-link">Artificial Intelligence</a></li><li><a href="/article/info-technology/web-crawler/" class="sidebar-link">Web Crawler</a></li><li><a href="/article/info-technology/web-frontend/" class="sidebar-link">Web Frontend</a></li><li><a href="/article/info-technology/web-backend/" class="sidebar-link">Web Backend</a></li><li><a href="/article/info-technology/web-security/" class="sidebar-link">Web Security</a></li><li><a href="/article/info-technology/system-management/" class="sidebar-link">System Management</a></li><li><a href="/article/info-technology/other/" class="sidebar-link">Other</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="algorithm-matrix-operation-lup-decomposition"><a href="#algorithm-matrix-operation-lup-decomposition" class="header-anchor">#</a> Algorithm - Matrix Operation - LUP Decomposition</h1> <p>Create Date: 2020.06.05</p> <p>Last Update Date: 2020.06.06</p> <p>By <a href="https://yuweiyin.github.io/" target="_blank" rel="noopener noreferrer">YuweiYin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <p>LUP 分解 (LUP Decomposition) 求解线性方程组</p> <p>很多应用都需要求解一组线性方程组。可以把一个线性方程组的表示成(未知变量的)系数矩阵方程，其中每个矩阵或向量元素属于一个域，通常是实数域 R。可以用 LUP 分解方法来求解线性方程组。</p> <p><img src="/img/info-technology/algorithm/other-topics/matrix-operation/lup-1.png" alt="lup-1"></p> <ul><li>如果矩阵 A 的秩小于未知变量数目 n，那么此线性方程组为<strong>欠定的</strong> (underdetermined)。
<ul><li>一个欠定方程组通常有无穷多解，但如果方程组不一致，则可能无解。</li></ul></li> <li>如果方程的数目超过未知变量数目 n，则该方程组为<strong>超定的</strong> (overdetermined)，且方程组可能无解。
<ul><li>但有一些方法能够寻找超定方程组的一个较好的近似解。</li></ul></li></ul> <p>这里主要考察 A 为非奇异矩阵的情况，即 A 的秩等于未知变量的个数 n（也即矩阵 A 的行列式 <code>|A|</code> 等于 0）。</p> <p>求解关于 n 个等式 n 个未知变量的线性方程组 Ax=b，可以先计算出矩阵 A 的逆矩阵 A^{-1}，然后等式两边同时左乘 A^{-1} 得到 x = A^{-1} b。但是此方法在实践中会有<strong>数值不稳定</strong>的问题，而 LUP 分解具有数值稳定性，且在实践中运行速度往往比求逆矩阵的解法更快。</p> <h2 id="lup-分解综述"><a href="#lup-分解综述" class="header-anchor">#</a> LUP 分解综述</h2> <p>LUP 分解背后的思想就是找出三个 n x n 的矩阵 L、U 和 P，满足 <strong>P·A = L·U</strong>。其中，L (lower) 是一个<strong>单位下三角矩阵</strong>，U (upper) 是一个<strong>上三角矩阵</strong>，而 P (permutation) 是一个(可逆的/非奇异的)<strong>置换矩阵</strong>(或称“排列矩阵”)。称满足等式 P·A = L·U 的矩阵 L、U 和 P 为 矩阵 A 的 <strong>LUP 分解</strong>。可以证明，每一个非奇异矩阵 A 都存在 LUP 分解。</p> <p><img src="/img/info-technology/algorithm/other-topics/matrix-operation/lup-2.png" alt="lup-2"></p> <p>计算矩阵 A 的一个 LUP 分解的优点是，当相应矩阵（如矩阵 L 和 U）为三角矩阵时，可以很容易地求解线性系统 Ax = b。在等式两边同时左乘 P，得到 PAx = Pb，这意味着置换矩阵 P 对原系数矩阵 A 进行了置换操作，得到 LUx = Pb。现在可以把问题转换为求解两个<strong>三角形线性系统</strong>的解。</p> <ol><li>首先，定义 y = Ux，其中 x 就是 LUx = Pb 中的 x（待求解的向量）。</li> <li>然后，通过 <strong>正向替换</strong> 的方法求解 <strong>下三角系统</strong> Ly = Pb，得到向量 y 的解。</li> <li>最后，通过 <strong>反向替换</strong> 的方法求解 <strong>上三角系统</strong> Ux = y，得到待求解的目标向量 x。</li></ol> <h3 id="正向替换-反向替换"><a href="#正向替换-反向替换" class="header-anchor">#</a> 正向替换 &amp; 反向替换</h3> <p>在已知 L、P 和 b 的情况下，正向替换可以在 $ \Theta(n^2) $ 的时间内求解下三角系统 Ly = Pb。由于置换矩阵 P 每行每列有且仅有一个 1，其余位置均为 0，所以可以用一个长度为 n 的向量 p[1..n] 来简洁地表达：元素 p[i] 表示矩阵 P[i, p[i]] = 1。因此，矩阵乘积 PA 的第 i 行第 j 列的元素为 $ a_{p[i], j} $，而向量 Pb 的第 i 个元素为 $ b_{p[i]} $。</p> <p>由于 L 是单位下三角矩阵（主对角线均为 1 的下三角矩阵），可以重写 Ly = Pb 如下：</p> <p><img src="/img/info-technology/algorithm/other-topics/matrix-operation/lup-3.png" alt="lup-3"></p> <p>第一个等式可以直接得到 $ y1 = b_{p[1]} $，得到 y1 后代入第二个等式，可以很容易地求解出 y2，依此类推，把 y1, y2, ..., y_{i-1} “正向替换” 到第 i 个等式中，就可以求解出 $ yi = b_{p[i]} - \sum_{j=1}^{i-1} lij · yj $。据此可求得向量 y。求解了 y 之后，利用“反向替换”求解等式 Ux = y，得到向量 x。</p> <p><img src="/img/info-technology/algorithm/other-topics/matrix-operation/lup-4.png" alt="lup-4"></p> <p>在已知 P、L、U 和 b 的情况下，可以调用下述过程 <code>LUP_SOLVE</code> 结合使用正向替换和反向替换，求出 x 的解。</p> <div class="language- extra-class"><pre class="language-text"><code>LUP_SOLVE(L, U, p, b)
1  n = L.rows
2  let x and y be a new vector of length n
3  for i = 1 to n
4      y_i = b[p[i]] - \sum_{j=1}^{i-1} (l_ij * y_i) 
5  for i = n downto 1
6      x_i = (y_i - \sum_{j=i+1}^{n} (u_ij * x_j)) / u_ii
7  return x
</code></pre></div><p>过程 <code>LUP_SOLVE</code> 在第 3～4 行中通过正向替换求出 y 的解，然后在第 5～6 行中通过反向替换求出 x 的解。因为在每个 for 循环的求和中隐含了一个循环，所以算法的运行时间为 $ \Theta(n^2) $。</p> <h3 id="计算一个-lu-分解"><a href="#计算一个-lu-分解" class="header-anchor">#</a> 计算一个 LU 分解</h3> <p>前面说明了，对于非奇异矩阵 A，如果能创建出其 LUP 分解，则可以运用正向替换与反向替换，可求出线性方程组 Ax=b 的解。此小节介绍如何高效地计算出矩阵 A 的一个 LUP 分解。</p> <p>先考虑 A 是 n x n 非奇异矩阵，且 P 不予考虑（或等价地，P = In 恒等方阵）。在这种情况下，分解 A = LU，称这两个矩阵 L 和 U 为 A 的一个 <strong>LU 分解</strong>。</p> <p>这里采用<strong>高斯消元法</strong> (Gaussian Elimination) 来创建一个 LU 分解。首先从其它方程中减去第一个方程的倍数，以把那些方程中的第一个变量消去。然后，从第三个及以后的方程中减去第二个方程的倍数，以把这些方程的第一个和第二个变量都消去。继续上述过程，直到系统变为一个上三角矩阵形式，此矩阵就是 LU 分解中的 U (Upper) 上三角矩阵。而矩阵 L 是由消去变量所用的行的乘数组成。</p> <p><img src="/img/info-technology/algorithm/other-topics/matrix-operation/lup-5.png" alt="lup-5"></p> <p><img src="/img/info-technology/algorithm/other-topics/matrix-operation/lup-6.png" alt="lup-6"></p> <p>但是如果元素 a11 == 0，<strong>舒尔补</strong> (Schur complement) A' 会有除 0 的问题。另外，如果 舒尔补 这个 (n-1) x (n-1) 矩阵的左上角元素为 0，上述分解方法也不可行，因为下一次递归就要除以此元素。</p> <p>在 LUP 分解中，所除的元素被称为 <strong>主元</strong> (pivot)，它们处于矩阵 U 的主对角线上。在 LUP 中包含一个置换矩阵 P 正是为了避免递归分解过程中把 0 当作除数。采用置换来避免除数为 0（或者一个接近于 0 的很小的数，除以这样的数可能会引起数值不稳定性）的操作被称为 <strong>选主元</strong> (pivoting)。</p> <p>保证 LU 分解总能进行的一类重要矩阵是<strong>对称正定矩阵</strong>。这一类矩阵无需选主元，因此可以不使用置换矩阵 P 就应用前述递归策略，无需担心除数为 0。</p> <p>对一个矩阵 A 进行 LU 分解的代码根据上述递归策略设计，并且将尾递归（即最后的操作为自身递归调用的过程）改为迭代循环过程。初始化<strong>上三角矩阵 U</strong>，使其对角线以下元素均为 0；初始化<strong>单位下三角矩阵 L</strong>，使其对角线以上元素均为 0，并且主对角线元素均为 1。每次迭代都作用于一个子方阵，以其左上角元素为为<strong>主元</strong>来计算向量 v 和 w 以及舒尔补 A'，这样又会生成一个子方阵，以供下次迭代作用。</p> <div class="language- extra-class"><pre class="language-text"><code>LU_DECOMPOSITION(A)
1  n = A.rows
2  let L and U be new n x n matrices
3  initialize U with 0s below the diagonal
4  initialize L with 1s on the diagonal and 0s above the diagonal
5  for k = 1 to n
6      u_kk = a_kk
7      for i = k+1 to n
8          l_ik = a_ik / u_kk    // a_ik holds vi
9          u_ki = a_ki           // a_ki holds wi
10     for i = k+1 to n
11         for j = k+1 to n
12             a_ij = a_ij - l_ik * u_kj
13 return L and U
</code></pre></div><p>算法过程描述如下：</p> <ol><li>在 1 行，获取矩阵规模</li> <li>在 2～4 行，初始化单位下三角矩阵 L 和上三角矩阵 U。</li> <li>在 5～12 行的循环中，对不同规模的矩阵进行 LU 分解。
<ul><li>在 6 行，选取主元为 <code>U[k][k] = A[k][k]</code></li> <li>在 7～9 行的 for 循环（当 k == n 时，此循环不执行）中，采用向量 v 和 w^{T} 对 L 和 U 进行更新。
<ul><li>在 8 行，把 <code>v[i]</code> 除以主元 <code>U[k][k]</code> 的结果存放在 <code>L[i][k]</code> 中（这里除以主元，第 12 行就不用除了）</li> <li>在 9 行，把 <code>w[i]</code> 存放在 <code>U[k][i]</code> 中</li></ul></li> <li>在 10～12 行的 for 循环中，计算舒尔补中的元素，并把结果存放在 <code>A[i][j]</code> 中</li></ul></li> <li>在 13 行，最终返回矩阵 L 和 U</li></ol> <p>由于该算法有三层循环嵌套，所以 <code>LU_DECOMPOSITION(A)</code> 的运行时间为 $ \Theta(n^3) $。另外，可以对上述算法的空间复杂度优化，不必新建 L 和 U 矩阵，而是直接利用矩阵 A 的空间来存储 L 和 U 的元素（因为不会重复利用之前的 A 中元素），做法只需把伪代码中的每处 l 和 u 用 a 取代即可。</p> <p><img src="/img/info-technology/algorithm/other-topics/matrix-operation/lup-7.png" alt="lup-7"></p> <h3 id="计算一个-lup-分解"><a href="#计算一个-lup-分解" class="header-anchor">#</a> 计算一个 LUP 分解</h3> <p>前面提到，如果 A 是<strong>对称正定矩阵</strong>，可以不使用置换矩阵 P 就应用前述递归策略，无需担心除数为 0。但对于任意的矩阵 A 而言，为了求解线性方程组 Ax=b，必须在 A 的非对角线元素中选主元以避免除数为 0。除数为 0 当然是灾难性的，但是也应避免除数很接近于 0（即便 A 是非奇异的），否则会产生数值不稳定。因此，需要选择一个较大的主元。</p> <p>LUP 分解的数学原理与 LU 分解很类似。在对矩阵 A 进行划分之前，先把一个非零元素（比如 ak1）从第一列中某个位置移动到该矩阵的 (1, 1) 的位置上。为了保证数值稳定性，选择第 1 列中具有最大绝对值的元素为 ak1。（由于矩阵 A 是非奇异的，所以其任何列都不可能全为 0）为了使方程组仍然成立，把第 1 行与第 k 行互换，这等价于用一个置换矩阵 Q 乘以 A 的左边。</p> <p>因此可以把 QA 写成：<code>QA = [[ak1, w^{T}], [v, A']]</code>。其中 <code>v = (a21, a31, ..., an1)^T</code>，除了 a11 取代 ak1；<code>w^{T} = (ak2, ak3, ..., akn)</code>；而舒尔补 A' 是一个 (n-1) x (n-1) 规模的矩阵。</p> <p><img src="/img/info-technology/algorithm/other-topics/matrix-operation/lup-8.png" alt="lup-8"></p> <p>注意在上述推导中，与 LU 分解不同的是：必须把列向量 <code>v / ak1</code> 和 舒尔补 <code>A' - v·w^{T} / ak1</code> 都乘以置换矩阵 P'。下面是 LUP 分解的伪代码：</p> <div class="language- extra-class"><pre class="language-text"><code>LUP_DECOMPOSITION(A)
1  n = A.rows
2  let p[1..n] be a new array
3  for i = 1 to n
4      p[i] = i
5  for k = 1 to n
6      p = 0
7      for i = k to n
8          if |a_ik| &gt; p
9              p = |a_ik|
10             k' = i
11     if p == 0
12         error &quot;A is a singular matrix&quot;
13     exchange p[k] with p[k']
14     for i = 1 to n
15         exchange a_ki with a_k'i
16     for i = k+1 to n
17         a_ik = a_ik / a_kk
18         for j = k+1 to n
19             a_ij = a_ij - a_ik * a_kj
20 return A
</code></pre></div><p>作为 LU 分解的改进，动态维护置换矩阵呢 P 作为一个长度为 n 的数组 p，其中 p[i] == j 表示置换矩阵 P 的元素 <code>P[i][j] == 1</code>。上述算法在 6～10 行选择了主元，实现了在矩阵 A 中使用“合适的主元”来计算 L 和 U，并在 13 行维护置换矩阵 p。另外在 14～15 行，把置换操作应用在矩阵 A 上。</p> <p>当过程 <code>LUP_DECOMPOSITION(A)</code> 结束时，矩阵 A 中同时保存了 L 和 U 的元素：</p> <ul><li>如果 i &gt;  j，则 <code>A[i][j] == L[i][j]</code></li> <li>如果 i &lt;= j，则 <code>A[i][j] == U[i][j]</code></li></ul> <p>当然，如果不希望改变原矩阵 A，可以在算法一开始重新开辟一个二维数组，并赋值为 A 即可。</p> <p><img src="/img/info-technology/algorithm/other-topics/matrix-operation/lup-9.png" alt="lup-9"></p> <p>因为 <code>LUP_DECOMPOSITION</code> 的三重循环结构，所以它的运行时间为 $ \Theta(n^3) $，与 <code>LU_DECOMPOSITION</code> 的渐近运行时间一样。选主元的操作至多花费常数因子时间。</p> <h2 id="矩阵求逆"><a href="#矩阵求逆" class="header-anchor">#</a> 矩阵求逆</h2> <p>虽然在实际应用中，一般不使用逆矩阵来求解线性方程组，而更倾向于运用一些数值稳定性更好的技术，如 LUP 分解。但是有时候需要计算一个矩阵的逆矩阵，来完成别的任务。而 LUP 分解也可以用于计算一个矩阵的逆。</p> <p>另外，可以证明 矩阵乘法 和 计算逆矩阵问题 具有相同的渐近时间复杂度，可以用用于矩阵乘法的 <a href="../../divide-conquer/matrix-strassen">Strassen 算法</a> 来求一个矩阵的逆矩阵。事实上，Strassen 原始论文的动机正是表明有比普通方法更快的求解线性方程组的方法。</p> <h3 id="通过-lup-分解计算逆矩阵"><a href="#通过-lup-分解计算逆矩阵" class="header-anchor">#</a> 通过 LUP 分解计算逆矩阵</h3> <p>假设有一个矩阵 A 的 LUP 分解，包括三个矩阵 L、U 和 P，满足 P·A = L·U。运用 <code>LUP_SOLVE</code> 过程，可以在 $ \Theta(n^2) $ 时间内求解一个具有 Ax=b 形式的方程。因为 LUP 分解取决于 A 而不是 b，所以改变向量 b，能够不必重算 LUP 分解，直接在第二个方程 Ax=b' 上运行 <code>LUP_SOLVE</code> 过程。</p> <p>考虑方程 A·X = In（其中 In 为单位矩阵），它以一个含 n 个方程（每个方程的形式为 Ax=b）的方程组方式定义了矩阵 X，即 A 的逆矩阵。令 Xi 表示 X 的第 i 列，单位向量 ei 是 In 的第 i 列，于是可以利用 A 的 LUP 分解来求解方程 A·X = In 中的 X，即分别求解每一个方程 A·Xi = ei 中的 Xi 即可。</p> <p>一旦以 $ \Theta(n^3) $ 运行时间得到矩阵 A 的 LUP 分解后，就可以在 $ \Theta(n^2) $ 时间内计算每个 Xi，因此总共可以在 $ \Theta(n^3) $ 的时间内求出矩阵 A 的逆矩阵 A^{-1}。</p> <h3 id="矩阵乘法和矩阵求逆"><a href="#矩阵乘法和矩阵求逆" class="header-anchor">#</a> 矩阵乘法和矩阵求逆</h3> <p>可以证明，矩阵乘法获得的理论上的加速比，矩阵求逆的运算同样可以达到。实际上，更进一步可以得到更强的结论：从下面描述的角度看来，矩阵求逆运算<strong>等价于</strong>矩阵乘法运算。</p> <p>如果 M(n) 表示求两个 n x n 矩阵乘积所需的时间，那么可以在 O(M(n)) 时间内对一个 n x n 的非奇异矩阵求逆。此外，如果 I(n) 表示对一个非奇异的 n x n 矩阵求逆所需的时间（I 表示 Inverse），那么可以在 O(I(n)) 时间内对两个 n x n 矩阵求乘积。下面的两个定理用于证明前述结论。</p> <p>《CLRS》<strong>定理 28.1</strong>（<strong>矩阵乘法不比矩阵求逆更困难</strong>）：如果能在 I(n) 时间内求出一个 n x n 的<strong>非奇异矩阵的逆</strong>，其中 I(n) = $ \Omega(n^2) $ 且 I(n) 满足<strong>正则性条件</strong> I(3n) = O(I(n))，那么可以在 O(I(n)) 时间内求出两个 n x n 矩阵的乘积。</p> <p><img src="/img/info-technology/algorithm/other-topics/matrix-operation/lup-10.png" alt="lup-10"></p> <p>《CLRS》<strong>定理 28.2</strong>（<strong>矩阵求逆不比矩阵乘法更困难</strong>）：如果能在 M(n) 时间内求出两个 n x n 的<strong>实数</strong>矩阵的乘积，其中 M(n) = $ \Omega(n^2) $ 且 M(n) 满足<strong>两个正则性条件</strong>：1. 对<strong>任意的 k</strong> (0 &lt;= k &lt;= n) 有 M(n+k) = O(M(n))；2. 对<strong>某个常数 c</strong> &lt; 1/2 有 M(n/2) &lt;= c M(n)，那么可以在 O(M(n)) 时间内求出<strong>任何一个</strong> n x n <strong>非奇异实数矩阵</strong>的逆。</p> <p>定理 28.2 的证明赖于<strong>对称正定矩阵</strong>的一些性质，证明详见《CLRS》Chapter 28.2 和 28.3。</p> <p>定理 28.2 的证明过程还说明：只要 A 是<strong>非奇异矩阵</strong>，就可以通过 LU 分解求解方程 Ax=b，而<strong>无需使用置换矩阵</strong> P 来选取主元。在 A 是非奇异矩阵的情况下，把等式两边同时左乘 A^{T} 得到 (A^{T} A)x = A^{T} b。因为 A^{T} 是可逆的，所以这一变换不会影响解 x，于是可以通过计算 LU 的一个分解来分解<strong>对称正定矩阵 A^{T} A</strong>。然后就可以对方程右端的 A^{T} b 应用<strong>正向替换</strong>和<strong>反向替换</strong>来求解 x。</p> <p>上述这样操作在理论上是能正确求解 x 的，但实际上过程 <code>LUP_DECOMPOSITION</code> 执行得更快。LUP 分解需要的算术运算次数要比上述方法少常数倍，并且 LUP 分解往往有更好的数值稳定性。</p> <hr> <p>此外，可以推广定理 28.2 的矩阵求逆算法，使之能处理<strong>复数矩阵</strong>的情形。</p> <p>方法：用 A 的 <strong>共轭转置矩阵</strong> (conjugate transpose) A* 来替代 A 的转置矩阵（把 A 中的每个元素用其<strong>共轭复数</strong>来替代就得到矩阵 A*）。并且用 <strong>埃尔米特矩阵</strong> (Hermitian Matrix) 来替代对称矩阵（埃尔米特矩阵就是满足 A = A* 的矩阵 A）。</p> <h2 id="奇异值分解-svd"><a href="#奇异值分解-svd" class="header-anchor">#</a> 奇异值分解 SVD</h2> <p>奇异值分解 (Singular Value Decomposition, SVD) 是另一种重要的矩阵分解。</p> <p>SVD 把一个 m x n 矩阵 A 分解成 $ A = P \Sigma Q $，其中 $ \Sigma $ 是一个只在主对角线上有非零元素的 m x n 矩阵（往往对应着矩阵 A 的各个<strong>特征值</strong>，从高到低放置），P 是一个<strong>列</strong>互相<strong>标准正交</strong>的 m x m 方阵，Q 是一个<strong>列</strong>互相<strong>标准正交</strong>的 n x n 方阵。（如果两个向量内积为 0 并且每个向量范数为 1，则它们是<strong>标准正交</strong>的。）</p> <p>SVD 分解可用于矩阵的压缩，而由于图像等数据往往以矩阵方式存放，所以 SVD 可以用于压缩图像。“压缩”的实际做法就是保留下高特征值的部分，而舍去“不重要”的部分。普通的特征值分解仅针对于方阵，而 SVD 分解可以作用于一般的矩阵。</p> <h2 id="代码范例"><a href="#代码范例" class="header-anchor">#</a> 代码范例</h2> <h3 id="python"><a href="#python" class="header-anchor">#</a> Python</h3> <p>Python 环境：Python 3.7</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;=================================================
@Project : algorithm/other-topics/matrix-operation
@File    : lup-decomposition.py
@Author  : YuweiYin
@Date    : 2020-06-05
==================================================&quot;&quot;&quot;</span>

<span class="token keyword">import</span> sys
<span class="token keyword">import</span> time

<span class="token triple-quoted-string string">&quot;&quot;&quot;
- 矩阵运算 Matrix Operation
    - 矩阵检查
        - 合法性检查
        - 加/减法相容性检查 (两矩阵形状/规模相同)
        - 矩阵乘法相容性检查
    - 矩阵转置
    - 矩阵乘法
        - 普通矩阵乘法
        - 分治的矩阵乘法
        - Strassen 算法
    - 矩阵分解
        - LUP 三角分解 (LUP Decomposition) 求解线性方程组
        - SVD 奇异值分解
    - 矩阵求逆
        - 用 LUP 分解方法求矩阵的逆
    - 对称正定矩阵和最小二乘逼近
        - 求超定线性方程组的最小二乘解

参考资料：
Introduction to Algorithm (aka CLRS) Third Edition - Chapter 28
&quot;&quot;&quot;</span>


<span class="token keyword">class</span> <span class="token class-name">MatrixOperation</span><span class="token punctuation">:</span>
    <span class="token comment"># 辅助函数：输出一个矩阵(二维列表)</span>
    <span class="token comment"># 时间复杂度：O(n)</span>
    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">print_matrix</span><span class="token punctuation">(</span>matrix<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>matrix<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'输入的矩阵不合法，无法输出'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> row <span class="token keyword">in</span> matrix<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>

    <span class="token comment"># 辅助函数：检查一个 n x n 方阵是否行列数合法</span>
    <span class="token comment"># 时间复杂度：O(n)</span>
    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">check_square_matrix</span><span class="token punctuation">(</span>matrix<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>matrix<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        n_rows <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix<span class="token punctuation">)</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> matrix<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token operator">!=</span> n_rows<span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>

    <span class="token comment"># 辅助函数：检查一个 m x n 普通矩阵是否行列数合法</span>
    <span class="token comment"># 时间复杂度：O(m)</span>
    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">check_matrix</span><span class="token punctuation">(</span>matrix<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>matrix<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>matrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        n_cols <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> matrix<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token operator">!=</span> n_cols<span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>

    <span class="token comment"># 辅助函数：检查两个矩阵的形状/规模是否相同，若相同，则对矩阵加法/减法相容</span>
    <span class="token comment"># 假定两个矩阵的规模均为 m x n</span>
    <span class="token comment"># 时间复杂度：O(m)</span>
    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">check_same_shape</span><span class="token punctuation">(</span>m_a<span class="token punctuation">,</span> m_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>m_a<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>m_a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>m_b<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_b<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>m_b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        a_rows <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">)</span>
        a_cols <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b_rows <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_b<span class="token punctuation">)</span>
        b_cols <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> a_rows <span class="token operator">!=</span> b_rows <span class="token keyword">or</span> a_cols <span class="token operator">!=</span> b_cols<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>

    <span class="token comment"># 辅助函数：检查两个矩阵是否(对矩阵乘法)相容 (a 的列数等于 b 的行数)</span>
    <span class="token comment"># 假定矩阵 m_a 的规模为 p x q、矩阵 m_b 的规模为 q x r</span>
    <span class="token comment"># 时间复杂度：O(p + q)</span>
    <span class="token keyword">def</span> <span class="token function">check_multiply_compatibility</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> m_a<span class="token punctuation">,</span> m_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 先检查两个矩阵是否各自合法</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>check_matrix<span class="token punctuation">(</span>m_a<span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>check_matrix<span class="token punctuation">(</span>m_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        a_cols <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b_rows <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_b<span class="token punctuation">)</span>
        <span class="token keyword">if</span> a_cols <span class="token operator">!=</span> b_rows<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>

    <span class="token comment"># 辅助函数：矩阵加法</span>
    <span class="token comment"># 对应位置相加，需约束两矩阵形状相同</span>
    <span class="token comment"># 时间复杂度 O(n^2)</span>
    <span class="token keyword">def</span> <span class="token function">matrix_addition</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> m_a<span class="token punctuation">,</span> m_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 先检查两矩阵的形状/规模是否相同</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>check_same_shape<span class="token punctuation">(</span>m_a<span class="token punctuation">,</span> m_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 也可以直接把矩阵 m_b 的各值加到 m_a 中，不额外建立矩阵</span>
            res_matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    res_matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> m_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> m_b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
            <span class="token keyword">return</span> res_matrix
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'输入的两矩阵形状/规模不同，无法进行矩阵加法'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>

    <span class="token comment"># 辅助函数：矩阵减法</span>
    <span class="token comment"># 对应位置相减，需约束两矩阵形状相同</span>
    <span class="token comment"># 时间复杂度 O(n^2)</span>
    <span class="token keyword">def</span> <span class="token function">matrix_subtraction</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> m_a<span class="token punctuation">,</span> m_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 先检查两矩阵的形状/规模是否相同</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>check_same_shape<span class="token punctuation">(</span>m_a<span class="token punctuation">,</span> m_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 也可以直接用矩阵 m_b 的各值去减 m_a 的对应值，不额外建立矩阵</span>
            res_matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    res_matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> m_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span> m_b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
            <span class="token keyword">return</span> res_matrix
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'输入的两矩阵形状/规模不同，无法进行矩阵减法'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>

    <span class="token comment"># 辅助函数：矩阵转置</span>
    <span class="token comment"># 时间复杂度 O(n^2)</span>
    <span class="token comment"># 空间复杂度 O(n^2) 或 O(1)</span>
    <span class="token comment"># 如果原址转置，覆盖原矩阵，则可以降低空间复杂度到 O(1)</span>
    <span class="token comment"># 本实现中会创建一个新矩阵</span>
    <span class="token keyword">def</span> <span class="token function">matrix_transpose</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> matrix<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 先检查 matrix 是否为合法的矩阵</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>check_matrix<span class="token punctuation">(</span>matrix<span class="token punctuation">)</span><span class="token punctuation">:</span>
            n_rows <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix<span class="token punctuation">)</span>
            n_cols <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            res_matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_rows<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_cols<span class="token punctuation">)</span><span class="token punctuation">]</span>
            <span class="token keyword">return</span> res_matrix
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'输入的对象不是矩阵，无法进行矩阵转置'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>

    <span class="token comment"># 朴素的矩阵乘积运算</span>
    <span class="token comment"># 时间复杂度 \Theta(n^3)</span>
    <span class="token comment"># 空间复杂度 \Theta(n^2)</span>
    <span class="token keyword">def</span> <span class="token function">naive_mm</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 先检查两矩阵是否对乘法相容</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>check_multiply_compatibility<span class="token punctuation">(</span>matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
            n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span>
            res_matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
                        res_matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> matrix_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">*</span> matrix_b<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
            <span class="token keyword">return</span> res_matrix
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'输入的矩阵对乘法不相容，无法进行矩阵乘法'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>

    <span class="token comment"># 针对方阵的普通的分治法</span>
    <span class="token comment"># T(n) = 8T(n/2) + \Theta(n^2)</span>
    <span class="token comment"># 时间复杂度 \Theta(n^3)</span>
    <span class="token keyword">def</span> <span class="token function">divide_mm</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 先检查两矩阵是否对乘法相容</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>check_multiply_compatibility<span class="token punctuation">(</span>matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_divide_mm<span class="token punctuation">(</span>matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'输入的矩阵对乘法不相容，无法进行矩阵乘法'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">_divide_mm</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span>
        res_matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            res_matrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> matrix_a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> matrix_b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 矩阵拆分：从中间划分成四份</span>
            a_11<span class="token punctuation">,</span> a_12<span class="token punctuation">,</span> a_21<span class="token punctuation">,</span> a_22<span class="token punctuation">,</span> b_11<span class="token punctuation">,</span> b_12<span class="token punctuation">,</span> b_21<span class="token punctuation">,</span> b_22 <span class="token operator">=</span> self<span class="token punctuation">.</span>_matrix_split<span class="token punctuation">(</span>matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span>

            <span class="token comment"># 递归进行乘法后相加</span>
            res_11 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_divide_mm<span class="token punctuation">(</span>a_11<span class="token punctuation">,</span> b_11<span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_divide_mm<span class="token punctuation">(</span>a_12<span class="token punctuation">,</span> b_21<span class="token punctuation">)</span><span class="token punctuation">)</span>
            res_12 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_divide_mm<span class="token punctuation">(</span>a_11<span class="token punctuation">,</span> b_12<span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_divide_mm<span class="token punctuation">(</span>a_12<span class="token punctuation">,</span> b_22<span class="token punctuation">)</span><span class="token punctuation">)</span>
            res_21 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_divide_mm<span class="token punctuation">(</span>a_21<span class="token punctuation">,</span> b_11<span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_divide_mm<span class="token punctuation">(</span>a_22<span class="token punctuation">,</span> b_21<span class="token punctuation">)</span><span class="token punctuation">)</span>
            res_22 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_divide_mm<span class="token punctuation">(</span>a_21<span class="token punctuation">,</span> b_12<span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>_divide_mm<span class="token punctuation">(</span>a_22<span class="token punctuation">,</span> b_22<span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token comment"># 结果合并到 res_11 中</span>
            res_11<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>res_21<span class="token punctuation">)</span>
            res_12<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>res_22<span class="token punctuation">)</span>
            <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res_11<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res_12<span class="token punctuation">)</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>res_11<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                res_11<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>extend<span class="token punctuation">(</span>res_12<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            res_matrix <span class="token operator">=</span> res_11
        <span class="token comment"># 返回最终结果</span>
        <span class="token keyword">return</span> res_matrix

    <span class="token comment"># 辅助函数：矩阵拆分</span>
    <span class="token comment"># 从中间划分成四份</span>
    <span class="token comment"># 时间复杂度 O(n)</span>
    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">_matrix_split</span><span class="token punctuation">(</span>m_a<span class="token punctuation">,</span> m_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_b<span class="token punctuation">)</span>
        mid <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m_a<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>

        a_1 <span class="token operator">=</span> m_a<span class="token punctuation">[</span><span class="token punctuation">:</span>mid<span class="token punctuation">]</span>  <span class="token comment"># 前半 mid 行</span>
        a_2 <span class="token operator">=</span> m_a<span class="token punctuation">[</span>mid<span class="token punctuation">:</span><span class="token punctuation">]</span>  <span class="token comment"># 后半 mid 行</span>
        a_11 <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token punctuation">:</span>mid<span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> a_1<span class="token punctuation">]</span>
        a_12 <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span>mid<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> a_1<span class="token punctuation">]</span>
        a_21 <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token punctuation">:</span>mid<span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> a_2<span class="token punctuation">]</span>
        a_22 <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span>mid<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> a_2<span class="token punctuation">]</span>

        b_1 <span class="token operator">=</span> m_b<span class="token punctuation">[</span><span class="token punctuation">:</span>mid<span class="token punctuation">]</span>  <span class="token comment"># 前半 mid 行</span>
        b_2 <span class="token operator">=</span> m_b<span class="token punctuation">[</span>mid<span class="token punctuation">:</span><span class="token punctuation">]</span>  <span class="token comment"># 后半 mid 行</span>
        b_11 <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token punctuation">:</span>mid<span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> b_1<span class="token punctuation">]</span>
        b_12 <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span>mid<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> b_1<span class="token punctuation">]</span>
        b_21 <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token punctuation">:</span>mid<span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> b_2<span class="token punctuation">]</span>
        b_22 <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span>mid<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> b_2<span class="token punctuation">]</span>

        <span class="token keyword">return</span> a_11<span class="token punctuation">,</span> a_12<span class="token punctuation">,</span> a_21<span class="token punctuation">,</span> a_22<span class="token punctuation">,</span> b_11<span class="token punctuation">,</span> b_12<span class="token punctuation">,</span> b_21<span class="token punctuation">,</span> b_22

    <span class="token comment"># 矩阵乘法的 Strassen 算法</span>
    <span class="token comment"># 这里假定待乘方阵的大小 n 是 2 的正整数次幂</span>
    <span class="token comment"># 核心思想是：将普通分治法的 8 次乘法降为 7 次</span>
    <span class="token comment"># T(n) = 7T(n/2) + \Theta(n^2)</span>
    <span class="token comment"># 时间复杂度 \Theta(n^{log 7}) = O(n^2.81) = \Omega(n^2.80)</span>
    <span class="token keyword">def</span> <span class="token function">strassen_mm</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 先检查两矩阵是否对乘法相容</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>check_multiply_compatibility<span class="token punctuation">(</span>matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_strassen_mm<span class="token punctuation">(</span>matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'输入的矩阵对乘法不相容，无法进行矩阵乘法'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">_strassen_mm</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span>
        res_matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            res_matrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> matrix_a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> matrix_b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 矩阵拆分：从中间划分成四份</span>
            a_11<span class="token punctuation">,</span> a_12<span class="token punctuation">,</span> a_21<span class="token punctuation">,</span> a_22<span class="token punctuation">,</span> b_11<span class="token punctuation">,</span> b_12<span class="token punctuation">,</span> b_21<span class="token punctuation">,</span> b_22 <span class="token operator">=</span> self<span class="token punctuation">.</span>_matrix_split<span class="token punctuation">(</span>matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span>

            <span class="token comment"># 计算前述 8 个子矩阵的和或差，得到 10 个新的矩阵 s1..s10</span>
            s_1 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_subtraction<span class="token punctuation">(</span>b_12<span class="token punctuation">,</span> b_22<span class="token punctuation">)</span>
            s_2 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>a_11<span class="token punctuation">,</span> a_12<span class="token punctuation">)</span>
            s_3 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>a_21<span class="token punctuation">,</span> a_22<span class="token punctuation">)</span>
            s_4 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_subtraction<span class="token punctuation">(</span>b_21<span class="token punctuation">,</span> b_11<span class="token punctuation">)</span>
            s_5 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>a_11<span class="token punctuation">,</span> a_22<span class="token punctuation">)</span>
            s_6 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>b_11<span class="token punctuation">,</span> b_22<span class="token punctuation">)</span>
            s_7 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_subtraction<span class="token punctuation">(</span>a_12<span class="token punctuation">,</span> a_22<span class="token punctuation">)</span>
            s_8 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>b_21<span class="token punctuation">,</span> b_22<span class="token punctuation">)</span>
            s_9 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_subtraction<span class="token punctuation">(</span>a_11<span class="token punctuation">,</span> a_21<span class="token punctuation">)</span>
            s_10 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>b_11<span class="token punctuation">,</span> b_12<span class="token punctuation">)</span>

            <span class="token comment"># 利用前述所有子矩阵，进行 7 次递归的矩阵乘法，得到 p1..p7</span>
            p_1 <span class="token operator">=</span> self<span class="token punctuation">.</span>_strassen_mm<span class="token punctuation">(</span>a_11<span class="token punctuation">,</span> s_1<span class="token punctuation">)</span>
            p_2 <span class="token operator">=</span> self<span class="token punctuation">.</span>_strassen_mm<span class="token punctuation">(</span>s_2<span class="token punctuation">,</span> b_22<span class="token punctuation">)</span>
            p_3 <span class="token operator">=</span> self<span class="token punctuation">.</span>_strassen_mm<span class="token punctuation">(</span>s_3<span class="token punctuation">,</span> b_11<span class="token punctuation">)</span>
            p_4 <span class="token operator">=</span> self<span class="token punctuation">.</span>_strassen_mm<span class="token punctuation">(</span>a_22<span class="token punctuation">,</span> s_4<span class="token punctuation">)</span>
            p_5 <span class="token operator">=</span> self<span class="token punctuation">.</span>_strassen_mm<span class="token punctuation">(</span>s_5<span class="token punctuation">,</span> s_6<span class="token punctuation">)</span>
            p_6 <span class="token operator">=</span> self<span class="token punctuation">.</span>_strassen_mm<span class="token punctuation">(</span>s_7<span class="token punctuation">,</span> s_8<span class="token punctuation">)</span>
            p_7 <span class="token operator">=</span> self<span class="token punctuation">.</span>_strassen_mm<span class="token punctuation">(</span>s_9<span class="token punctuation">,</span> s_10<span class="token punctuation">)</span>

            <span class="token comment"># 对 p1..p7 进行加减运算得到最终结果的四个部分</span>
            <span class="token comment"># res_11 = p_5 + p_4 - p_2 + p_6</span>
            <span class="token comment"># res_22 = p_5 + p_1 - p_3 - p_7</span>
            res_11 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>self<span class="token punctuation">.</span>matrix_subtraction<span class="token punctuation">(</span>
                self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>p_5<span class="token punctuation">,</span> p_4<span class="token punctuation">)</span><span class="token punctuation">,</span> p_2<span class="token punctuation">)</span><span class="token punctuation">,</span> p_6<span class="token punctuation">)</span>
            res_12 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>p_1<span class="token punctuation">,</span> p_2<span class="token punctuation">)</span>
            res_21 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>p_3<span class="token punctuation">,</span> p_4<span class="token punctuation">)</span>
            res_22 <span class="token operator">=</span> self<span class="token punctuation">.</span>matrix_subtraction<span class="token punctuation">(</span>self<span class="token punctuation">.</span>matrix_subtraction<span class="token punctuation">(</span>
                self<span class="token punctuation">.</span>matrix_addition<span class="token punctuation">(</span>p_5<span class="token punctuation">,</span> p_1<span class="token punctuation">)</span><span class="token punctuation">,</span> p_3<span class="token punctuation">)</span><span class="token punctuation">,</span> p_7<span class="token punctuation">)</span>

            <span class="token comment"># 结果合并到 res_11 中</span>
            res_11<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>res_21<span class="token punctuation">)</span>
            res_12<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>res_22<span class="token punctuation">)</span>
            <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res_11<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res_12<span class="token punctuation">)</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>res_11<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                res_11<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>extend<span class="token punctuation">(</span>res_12<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            res_matrix <span class="token operator">=</span> res_11
        <span class="token comment"># 返回最终结果</span>
        <span class="token keyword">return</span> res_matrix

    <span class="token comment"># 用 LUP 分解的结果求解线性方程组 Ax = b</span>
    <span class="token comment"># LUP 分解：P·A = L·U</span>
    <span class="token comment"># L 是单位下三角矩阵、U 是上三角矩阵，P 是置换矩阵 (用一位向量 p 来表达)</span>
    <span class="token comment"># 时间复杂度：\Theta(n^2)</span>
    <span class="token comment"># 空间复杂度：\Theta(n)</span>
    <span class="token keyword">def</span> <span class="token function">lup_solve</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> lower<span class="token punctuation">,</span> upper<span class="token punctuation">,</span> permutation<span class="token punctuation">,</span> vector_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 0. 检查 L 和 U 矩阵是相同形状 n x n 的方阵，且置换&quot;矩阵&quot; p 的长度等于 n</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>check_same_shape<span class="token punctuation">(</span>lower<span class="token punctuation">,</span> upper<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'lup_solve: Error: L 与 U 的形状不同'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>
        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lower<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lower<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> n <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>upper<span class="token punctuation">)</span> <span class="token operator">!=</span> n <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>upper<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> n <span class="token keyword">or</span> \
                <span class="token builtin">len</span><span class="token punctuation">(</span>permutation<span class="token punctuation">)</span> <span class="token operator">!=</span> n <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>vector_b<span class="token punctuation">)</span> <span class="token operator">!=</span> n<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'lup_solve: Error: L 与 U 不为方阵，或者 p、b 输入不合法'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>

        <span class="token comment"># 1. 创建向量 x 和向量 y</span>
        vector_x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>
        vector_y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>

        <span class="token comment"># 2. 通过&quot;正向替换&quot;求出 y 的解</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            sum_ly <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
                sum_ly <span class="token operator">+=</span> lower<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> vector_y<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
            vector_y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> vector_b<span class="token punctuation">[</span>permutation<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">-</span> sum_ly

        <span class="token comment"># 3. 通过&quot;反向替换&quot;求出 x 的解</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sum_ux <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
                sum_ux <span class="token operator">+=</span> upper<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> vector_x<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
            vector_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>vector_y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> sum_ux<span class="token punctuation">)</span> <span class="token operator">/</span> upper<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>

        <span class="token comment"># 4. 返回计算出的解向量</span>
        <span class="token keyword">return</span> vector_x

    <span class="token comment"># 对方阵 A 进行 LU 分解</span>
    <span class="token comment"># 限制条件：每次循环时，待分解矩阵的左上角元素不能是 0，否则有除 0 异常；</span>
    <span class="token comment"># 另外，如果此左上角元素太接近 0，那么会造成比较严重的数值稳定性问题。</span>
    <span class="token comment"># 如果 A 是对称正定矩阵，那么可以不用担心上述限制条件。</span>
    <span class="token comment"># 而 LUP 分解针对上述限制条件进行了修正，可适用于任何非奇异矩阵 A 的分解</span>
    <span class="token comment"># 时间复杂度：\Theta(n^3)</span>
    <span class="token comment"># 空间复杂度：\Theta(n^2) 或者 O(1)</span>
    <span class="token comment"># 如果直接把 L 和 U 的元素值(覆盖修改)存储于方阵 A 中，则可以减少空间复杂度至 O(1)</span>
    <span class="token keyword">def</span> <span class="token function">lu_decomposition</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> matrix_a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 0. 检查 A 是方阵</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>check_square_matrix<span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'lu_decomposition: Error: 矩阵 A 不是方阵'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>

        <span class="token comment"># 1. 获取矩阵规模</span>
        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span>

        <span class="token comment"># 2. 初始化单位下三角矩阵 L 和上三角矩阵 U</span>
        lower <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>
        upper <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            lower<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>

        <span class="token comment"># 3. 在外循环中，对不同规模的矩阵进行 LU 分解</span>
        <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 3.1. 选取主元为 U[k][k] = A[k][k]</span>
            upper<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> matrix_a<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span>
            <span class="token comment"># 除 0 检测</span>
            <span class="token keyword">if</span> upper<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'lu_decomposition: Error: 主元 upper[k][k] 为 0，会有除 0 异常'</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
            <span class="token comment"># 除很接近于 0 的数检测</span>
            <span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>upper<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'lu_decomposition: Warning: 主元 upper[k][k] &lt; 1e-10，会影响数值稳定性'</span><span class="token punctuation">)</span>

            <span class="token comment"># 3.2. 在此内循环 (当 k == n - 1 时，内循环不执行) 中，采用向量 v 和 w^{T} 对 L 和 U 进行更新</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># 把 v[i] 除以主元 U[k][k] 的结果存放在 L[i][k] 中 (这里除以主元，后面就不用除了)</span>
                lower<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> matrix_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">/</span> upper<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span>
                <span class="token comment"># 把 w[i] 存放在 U[k][i] 中</span>
                upper<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> matrix_a<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>

            <span class="token comment"># 3.3. 在此内循环中，计算舒尔补中的元素，并把结果存放在 A[i][j] 中</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    matrix_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> lower<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">*</span> upper<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>

        <span class="token comment"># 4. 最终返回矩阵 L 和 U</span>
        <span class="token keyword">return</span> lower<span class="token punctuation">,</span> upper

    <span class="token comment"># 对方阵 A 进行 LUP 分解 (可适用于任何非奇异矩阵 A 的分解)</span>
    <span class="token comment"># 时间复杂度：\Theta(n^3)</span>
    <span class="token comment"># 空间复杂度：\Theta(n^2) 或者 O(1)</span>
    <span class="token comment"># 这里直接把 L 和 U 的元素值(覆盖修改)存储于方阵 A 中，减少空间复杂度至 O(1)</span>
    <span class="token comment"># 当然，如果不希望改变原矩阵 A，可以在算法一开始重新开辟一个二维数组，并赋值为 A 即可。</span>
    <span class="token keyword">def</span> <span class="token function">lup_decomposition</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> matrix_a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 0. 检查 A 是方阵</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>check_square_matrix<span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'lu_decomposition: Error: 矩阵 A 不是方阵'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>

        <span class="token comment"># 1. 获取矩阵规模</span>
        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span>

        <span class="token comment"># 2. 初始化置换矩阵 P 作为一个长度为 n 的数组 p</span>
        <span class="token comment"># 其中 p[i] == j 表示置换矩阵 P 的元素 P[i][j] == 1</span>
        permutation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            permutation<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i

        <span class="token comment"># 3. 在外循环中，对不同规模的矩阵进行 LUP 分解</span>
        <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 3.1. 选取主元，利用置换矩阵 P 实现了在矩阵 A 中使用“合适的主元”来计算 L 和 U</span>
            pivot <span class="token operator">=</span> <span class="token number">0</span>
            _k <span class="token operator">=</span> k
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># 在当前列中寻找最大的主元 pivot</span>
                <span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> pivot<span class="token punctuation">:</span>
                    pivot <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    _k <span class="token operator">=</span> i  <span class="token comment"># _k 作为选取的主元的下标，之后会记录在置换矩阵 P 中</span>
            <span class="token comment"># 除 0 检测</span>
            <span class="token keyword">if</span> pivot <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'lup_decomposition: Error: 输入矩阵为奇异矩阵，无法进行 LUP 分解'</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
            <span class="token comment"># 除很接近于 0 的数检测</span>
            <span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>pivot<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'lup_decomposition: Warning: 主元 pivot &lt; 1e-10，会影响数值稳定性'</span><span class="token punctuation">)</span>

            <span class="token comment"># 3.2. 如果选取的主元不是首个元素，则维护置换矩阵 P，并把置换操作应用在矩阵 A 上</span>
            <span class="token keyword">if</span> k <span class="token operator">!=</span> _k<span class="token punctuation">:</span>
                <span class="token comment"># 维护置换矩阵 P</span>
                temp <span class="token operator">=</span> permutation<span class="token punctuation">[</span>k<span class="token punctuation">]</span>
                permutation<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> permutation<span class="token punctuation">[</span>_k<span class="token punctuation">]</span>
                permutation<span class="token punctuation">[</span>_k<span class="token punctuation">]</span> <span class="token operator">=</span> temp
                <span class="token comment"># 把置换操作应用在矩阵 A 上</span>
                <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    temp <span class="token operator">=</span> matrix_a<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
                    matrix_a<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> matrix_a<span class="token punctuation">[</span>_k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
                    matrix_a<span class="token punctuation">[</span>_k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp

            <span class="token comment"># 3.3. 在此内循环中，计算舒尔补中的元素，并把结果存放在 A[i][j] 中</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
                matrix_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">/=</span> matrix_a<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span>
                <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    matrix_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> matrix_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">*</span> matrix_a<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>

        <span class="token comment"># 4. 最终返回矩阵 A 和置换矩阵(向量) P</span>
        <span class="token comment"># 当本函数结束时，矩阵 A 中同时保存了 L 和 U 的元素：</span>
        <span class="token comment"># - 如果下标 i &gt;  j，则 A[i][j] == L[i][j]</span>
        <span class="token comment"># - 如果下标 i &lt;= j，则 A[i][j] == U[i][j]</span>
        <span class="token keyword">return</span> matrix_a<span class="token punctuation">,</span> permutation

    <span class="token comment"># 用 LUP 分解方法 求非奇异方阵 A 的逆矩阵</span>
    <span class="token comment"># 方法：求 A·X=In，In 为单位矩阵，而 X 即为 A 的逆矩阵</span>
    <span class="token comment"># 用 LUP 分解求 n 个线性方程组 A·Xi = ei</span>
    <span class="token comment"># 其中 Xi 是方阵 X 的第 i 列列向量，ei 为单位矩阵 In 的第 i 列列向量</span>
    <span class="token comment"># 时间复杂度：\Theta(n^3)</span>
    <span class="token comment"># 空间复杂度：\Theta(n^2)</span>
    <span class="token keyword">def</span> <span class="token function">lup_reverse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> matrix_a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 0. 检查 A 是方阵</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>check_square_matrix<span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'lup_reverse: Error: 矩阵 A 不是方阵'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>

        <span class="token comment"># 1. LUP 分解</span>
        res_lu<span class="token punctuation">,</span> permutation <span class="token operator">=</span> self<span class="token punctuation">.</span>lup_decomposition<span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span>

        <span class="token comment"># 2. 根据 LUP 分解的 res_lu 获得 L 矩阵和 U 矩阵</span>
        <span class="token comment"># - 如果下标 i &gt;  j，则 A[i][j] == L[i][j]</span>
        <span class="token comment"># - 如果下标 i &lt;= j，则 A[i][j] == U[i][j]</span>
        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res_lu<span class="token punctuation">)</span>
        lower <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>
        upper <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            lower<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> i <span class="token operator">&gt;</span> j<span class="token punctuation">:</span>
                    lower<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> res_lu<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    upper<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> res_lu<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>

        <span class="token comment"># 用 LUP 分解求 n 个线性方程组 A·Xi = ei</span>
        reverse_a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            vector_b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token keyword">if</span> i <span class="token operator">==</span> j <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>
            res_x <span class="token operator">=</span> self<span class="token punctuation">.</span>lup_solve<span class="token punctuation">(</span>lower<span class="token punctuation">,</span> upper<span class="token punctuation">,</span> permutation<span class="token punctuation">,</span> vector_b<span class="token punctuation">)</span>
            <span class="token comment"># 把 res_x 加入二维列表 reverse_a 中 (作为行向量，最后需对 reverse_a 进行转置)</span>
            reverse_a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>res_x<span class="token punctuation">)</span>

        <span class="token comment"># 对 reverse_a 进行转置后返回结果</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>matrix_transpose<span class="token punctuation">(</span>reverse_a<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    mo <span class="token operator">=</span> MatrixOperation<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 矩阵乘法</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n矩阵乘法:'</span><span class="token punctuation">)</span>
    matrix_a <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
    matrix_b <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    res_matrix <span class="token operator">=</span> mo<span class="token punctuation">.</span>strassen_mm<span class="token punctuation">(</span>matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span>
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># res_matrix:</span>
    <span class="token comment"># [1, 20, 15, 16]</span>
    <span class="token comment"># [5, 44, 35, 40]</span>
    <span class="token comment"># [9, 68, 55, 64]</span>
    <span class="token comment"># [13, 92, 75, 88]</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>res_matrix<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res_matrix<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nres_matrix:'</span><span class="token punctuation">)</span>
        mo<span class="token punctuation">.</span>print_matrix<span class="token punctuation">(</span>res_matrix<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'矩阵相乘出错!'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Running Time: %.5f ms'</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># LU 分解</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nLU 分解:'</span><span class="token punctuation">)</span>
    <span class="token comment"># 用于 LU 分解的矩阵，同《CLRS》Chapter 28 中的图 28-1</span>
    matrix_lu <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    lower<span class="token punctuation">,</span> upper <span class="token operator">=</span> mo<span class="token punctuation">.</span>lu_decomposition<span class="token punctuation">(</span>matrix_lu<span class="token punctuation">)</span>
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># lower:</span>
    <span class="token comment"># [1, 0, 0, 0]</span>
    <span class="token comment"># [3, 1, 0, 0]</span>
    <span class="token comment"># [1, 4, 1, 0]</span>
    <span class="token comment"># [2, 1, 7, 1]</span>
    <span class="token comment"># upper:</span>
    <span class="token comment"># [2, 3, 1, 5]</span>
    <span class="token comment"># [0, 4, 2, 4]</span>
    <span class="token comment"># [0, 0, 1, 2]</span>
    <span class="token comment"># [0, 0, 0, 3]</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>lower<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lower<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> \
            <span class="token builtin">isinstance</span><span class="token punctuation">(</span>upper<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>upper<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nlower:'</span><span class="token punctuation">)</span>
        mo<span class="token punctuation">.</span>print_matrix<span class="token punctuation">(</span>lower<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nupper:'</span><span class="token punctuation">)</span>
        mo<span class="token punctuation">.</span>print_matrix<span class="token punctuation">(</span>upper<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'矩阵相乘出错!'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Running Time: %.5f ms'</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># LUP 分解</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nLUP 分解:'</span><span class="token punctuation">)</span>
    <span class="token comment"># 用于 LUP 分解的矩阵，同《CLRS》Chapter 28 中的图 28-2</span>
    matrix_lup <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3.4</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    res_lu<span class="token punctuation">,</span> permutation <span class="token operator">=</span> mo<span class="token punctuation">.</span>lup_decomposition<span class="token punctuation">(</span>matrix_lup<span class="token punctuation">)</span>
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># res_lu:</span>
    <span class="token comment"># [5, 5, 4, 2]</span>
    <span class="token comment"># [0.4, -2, 0.4, -0.2]</span>
    <span class="token comment"># [-0.2, 0.5, 4, -0.5]</span>
    <span class="token comment"># [0.6, 0, 0.4, -3]</span>
    <span class="token comment"># permutation:</span>
    <span class="token comment"># [2, 0, 3, 1]</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>res_lu<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res_lu<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> \
            <span class="token builtin">isinstance</span><span class="token punctuation">(</span>permutation<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>permutation<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nres_lu:'</span><span class="token punctuation">)</span>
        mo<span class="token punctuation">.</span>print_matrix<span class="token punctuation">(</span>res_lu<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\npermutation:'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>permutation<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'矩阵相乘出错!'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Running Time: %.5f ms'</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># 用 LUP 分解方法 求解线性方程组 Ax=b</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n用 LUP 分解方法 求解线性方程组:'</span><span class="token punctuation">)</span>
    <span class="token comment"># 用于 LUP 分解的矩阵，同《CLRS》Chapter 28 第一小节中的例子</span>
    matrix_lup_solve <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
    vector_b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span>
    <span class="token comment"># LUP 分解</span>
    res_lu<span class="token punctuation">,</span> permutation <span class="token operator">=</span> mo<span class="token punctuation">.</span>lup_decomposition<span class="token punctuation">(</span>matrix_lup_solve<span class="token punctuation">)</span>
    <span class="token comment"># 根据 LUP 分解的 res_lu 获得 L 矩阵和 U 矩阵</span>
    <span class="token comment"># - 如果下标 i &gt;  j，则 A[i][j] == L[i][j]</span>
    <span class="token comment"># - 如果下标 i &lt;= j，则 A[i][j] == U[i][j]</span>
    n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res_lu<span class="token punctuation">)</span>
    lower <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>
    upper <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        lower<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i <span class="token operator">&gt;</span> j<span class="token punctuation">:</span>
                lower<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> res_lu<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                upper<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> res_lu<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
    <span class="token comment"># 输出展示 L、U 和 P 矩阵</span>
    <span class="token comment"># lower:</span>
    <span class="token comment"># [1, 0, 0]</span>
    <span class="token comment"># [0.2, 1, 0]</span>
    <span class="token comment"># [0.6, 0.5, 1]</span>
    <span class="token comment"># upper:</span>
    <span class="token comment"># [5, 6, 3]</span>
    <span class="token comment"># [0, 0.8, -0.6]</span>
    <span class="token comment"># [0, 0, 2.5]</span>
    <span class="token comment"># permutation:</span>
    <span class="token comment"># [2, 0, 1]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nlower:'</span><span class="token punctuation">)</span>
    mo<span class="token punctuation">.</span>print_matrix<span class="token punctuation">(</span>lower<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nupper:'</span><span class="token punctuation">)</span>
    mo<span class="token punctuation">.</span>print_matrix<span class="token punctuation">(</span>upper<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\npermutation:'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>permutation<span class="token punctuation">)</span>
    <span class="token comment"># 使用 L、U、p 和 b 解线性方程组</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    res_x <span class="token operator">=</span> mo<span class="token punctuation">.</span>lup_solve<span class="token punctuation">(</span>lower<span class="token punctuation">,</span> upper<span class="token punctuation">,</span> permutation<span class="token punctuation">,</span> vector_b<span class="token punctuation">)</span>
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 输出解向量</span>
    <span class="token comment"># res_x:</span>
    <span class="token comment"># [-1.4, 2.2, 0.6]</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>res_x<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res_x<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nres_x:'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>res_x<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'解线性方程组出错!'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Running Time: %.5f ms'</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># 用 LUP 分解方法 求非奇异方阵 A 的逆矩阵</span>
    <span class="token comment"># 方法：求 A·X=In，In 为单位矩阵，而 X 即为 A 的逆矩阵</span>
    <span class="token comment"># 用 LUP 分解求 n 个线性方程组 A·Xi = ei</span>
    <span class="token comment"># 其中 Xi 是方阵 X 的第 i 列列向量，ei 为单位矩阵 In 的第 i 列列向量</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n用 LUP 分解方法 求非奇异方阵 A 的逆矩阵:'</span><span class="token punctuation">)</span>
    matrix_lup_reverse <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>

    <span class="token comment"># 这里需要保留原矩阵，所以用副本去执行求逆运算 (本实现中的 LUP 分解过程会覆盖输入的矩阵 A)</span>
    matrix_lup_reverse_copy <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span>matrix_lup_reverse<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>matrix_lup_reverse<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>matrix_lup_reverse<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    reverse_matrix <span class="token operator">=</span> mo<span class="token punctuation">.</span>lup_reverse<span class="token punctuation">(</span>matrix_lup_reverse_copy<span class="token punctuation">)</span>
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 输出结果</span>
    <span class="token comment"># reverse_matrix:</span>
    <span class="token comment"># [-1.2, -0.6, 0.8]</span>
    <span class="token comment"># [1.1, 0.3, -0.4]</span>
    <span class="token comment"># [-0.2, 0.4, -0.2]</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>reverse_matrix<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>reverse_matrix<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nreverse_matrix:'</span><span class="token punctuation">)</span>
        mo<span class="token punctuation">.</span>print_matrix<span class="token punctuation">(</span>reverse_matrix<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'解线性方程组出错!'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Running Time: %.5f ms'</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># 将求逆后的矩阵与原矩阵进行左乘/右乘，确认结果为 In 单位矩阵</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n逆矩阵右乘以原矩阵:'</span><span class="token punctuation">)</span>
    mm_res_matrix <span class="token operator">=</span> mo<span class="token punctuation">.</span>naive_mm<span class="token punctuation">(</span>matrix_lup_reverse<span class="token punctuation">,</span> reverse_matrix<span class="token punctuation">)</span>
    mo<span class="token punctuation">.</span>print_matrix<span class="token punctuation">(</span>mm_res_matrix<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n逆矩阵左乘以原矩阵:'</span><span class="token punctuation">)</span>
    mm_res_matrix <span class="token operator">=</span> mo<span class="token punctuation">.</span>naive_mm<span class="token punctuation">(</span>reverse_matrix<span class="token punctuation">,</span> matrix_lup_reverse<span class="token punctuation">)</span>
    mo<span class="token punctuation">.</span>print_matrix<span class="token punctuation">(</span>mm_res_matrix<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ul><li>Introduction to Algorithm (aka CLRS) Third Edition - Chapter 28</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.338776d8.js" defer></script><script src="/assets/js/2.5e710586.js" defer></script><script src="/assets/js/76.c65d8991.js" defer></script>
  </body>
</html>
